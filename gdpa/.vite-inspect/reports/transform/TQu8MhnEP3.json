{
  "resolvedId": "/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Bricks/Transfer.vue?vue&type=script&setup=true&lang.ts",
  "transforms": [
    {
      "name": "vite:vue",
      "result": "import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-b1484c1a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" }\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" }\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"从\", -1 /* HOISTED */))\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"到\", -1 /* HOISTED */))\nconst _hoisted_7 = { class: \"row-item flex items-center\" }\nconst _hoisted_8 = [\"src\"]\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"矿工币\", -1 /* HOISTED */))\nconst _hoisted_10 = { class: \"row-item flex items-center\" }\nconst _hoisted_11 = [\"src\"]\nconst _hoisted_12 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"USDT泰达币\", -1 /* HOISTED */))\nconst _hoisted_13 = { class: \"self-center\" }\nconst _hoisted_14 = [\"src\"]\nconst _hoisted_15 = { class: \"transfer-info-container\" }\nconst _hoisted_16 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"amount-text\" }, \"划转数量\", -1 /* HOISTED */))\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" }\nconst _hoisted_18 = { class: \"coin-unit\" }\nconst _hoisted_19 = { class: \"item-info-container\" }\nconst _hoisted_20 = { class: \"label\" }\nconst _hoisted_21 = { class: \"value flex items-center\" }\nconst _hoisted_22 = { key: 0 }\nconst _hoisted_23 = { class: \"unit\" }\n\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from 'vue'\nimport { useRoute } from 'vue-router'\nimport transfer01 from '@/assets/images/bricks/transfer01.png'\nimport transfer02 from '@/assets/images/bricks/transfer02.png'\nimport KGB01 from '@/assets/images/bricks/KGB01.png'\nimport USDT01 from '@/assets/images/bricks/USDT01.png'\nimport { useAuthStore } from '@/store'\nimport { storeToRefs } from 'pinia'\nimport { showToast } from 'vant'\nimport info from '@/assets/images/common/info.png'\nimport success from '@/assets/images/common/success.png'\nimport { getMoneyExchargeApi } from '@/apis/user'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Transfer',\n  setup(__props) {\n\nconst authStore = useAuthStore()\nconst { getUserCoin } = authStore\nconst { coins } = storeToRefs(authStore)\n\nconst route = useRoute()\n\n// 路由参数对应划转币种映射表\nconst routeParamsMap = {\n  'kgb-to-usdt': {\n    mtype: 30,\n    unit: 'CNY'\n  },\n  'usdt-to-kgb': {\n    mtype: 2,\n    unit: 'USDT'\n  }\n} as Record<string, any>\n\nconst [from, to] = (route.params.coin as string).split('-to-')\n\n// 币种划转映射表\nconst transferMap = ref({\n  from: routeParamsMap[from + '-to-' + to],\n  to: routeParamsMap[to + '-to-' + from]\n})\n// 划转条目信息\nconst transferCoinsInfo = ref([\n  { label: '可用金额', value: '0.00' },\n  { label: '手续费(0%)', value: '0.00' },\n  { label: '当前汇率', value: '0.00' },\n  { label: '划转获得', value: '0.00' },\n  { label: '最小划转数量', value: '0.00' }\n])\n// 划转数量\nconst transferCoinsAmount = ref('')\nconst inputAmount = ref()\n\n// 币种信息\nconst coinInfo = computed(() =>\n  coins.value?.find(item => item.mtype === transferMap.value.from.mtype)\n)\n// 转换目标币种信息\nconst toCoinInfo = computed(() =>\n  coins.value?.find(item => item.mtype === transferMap.value.to.mtype)\n)\n// 当前汇率\nconst currExchangeRate = computed(() => {\n  const fromCoinPrice = +(coinInfo.value?.coinset_config?.coin_price || 0)\n  const toCoinPrice = +(\n    coins.value?.find(item => item.mtype === transferMap.value.to.mtype)?.coinset_config\n      ?.coin_price || 1\n  )\n\n  return (fromCoinPrice / toCoinPrice).toTruncFixed(3)\n})\n// 最小划转数量\nconst minTransferAmount = computed(() => {\n  if (!coinInfo.value?.coinset_config) return '0.00'\n\n  return (\n    +coinInfo.value!.coinset_config!.min_swapto / +coinInfo.value!.coinset_config!.coin_price\n  ).toTruncFixed(2)\n})\n// 最大可划转数量(扣减手续费后)\nconst maxAvailableTransfer = computed(\n  () => +coinInfo.value!.available_coincash / (1 + +coinInfo.value!.coinset_config!.swapto_fee)\n)\n\n// 修正光标位置\nconst updateCursorPos = (onlyUpdateValue = false) => {\n  setTimeout(() => {\n    let amountInputEl = document.querySelector('.amount-input input') as HTMLInputElement\n\n    if (amountInputEl) {\n      amountInputEl.value = transferCoinsAmount.value\n\n      if (onlyUpdateValue) {\n        // 释放dom引用\n        amountInputEl = null as any\n        return\n      }\n\n      // 光标开始处\n      amountInputEl.selectionStart = transferCoinsAmount.value.length\n      // 光标结束处\n      amountInputEl.selectionEnd = transferCoinsAmount.value.length\n      // 释放dom引用\n      amountInputEl = null as any\n    }\n  }, 20)\n}\n\n// 输入内容修正\nwatch(transferCoinsAmount, (val, oldVal) => {\n  // 小数点开头，自动补齐0.\n  if (val === '.' || val.startsWith('00')) {\n    transferCoinsAmount.value = '0.'\n    updateCursorPos()\n    return\n  }\n\n  // 00开头变为0\n  if (oldVal && val.startsWith('0')) {\n    transferCoinsAmount.value = '0'\n  }\n\n  // 小数位数保留2位\n  const dotIndex = val.indexOf('.')\n  if (~dotIndex) {\n    const str = val.slice(dotIndex + 1, val.length)\n    const replacer = (match: string, p1: string, p2: string) => {\n      if (p1.startsWith('0') && +p1 > 0) {\n        return '0'\n      }\n      return p1 + '.' + p2\n    }\n    const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer)\n\n    transferCoinsAmount.value = newAmount\n    updateCursorPos(true)\n    return\n  }\n\n  // 提币输入超过最大提币数量时，变为最大可提币输入\n  if (+val > +maxAvailableTransfer.value) {\n    transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2)\n    updateCursorPos()\n  }\n})\n\n// 更新划转相关条目配置数据\nwatchEffect(() => {\n  // 手续费费率\n  const swaptoFeeRate = +(coinInfo.value?.coinset_config?.swapto_fee || 0)\n  // 手续费\n  const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2)\n  // 可用金额\n  const availableCoincash = (+coinInfo.value!.available_coincash).toTruncFixed(2)\n  // 划转获得\n  const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n    2\n  )\n\n  transferCoinsInfo.value = [\n    { label: '可用金额', value: availableCoincash },\n    {\n      label: `手续费(${swaptoFeeRate * 100}%)`,\n      value: swaptoFee\n    },\n    {\n      label: '当前汇率',\n      value: currExchangeRate.value\n    },\n    {\n      label: '划转获得',\n      value: finalCoincash\n    },\n    {\n      label: '最小划转数量',\n      value: minTransferAmount.value\n    }\n  ]\n})\n\n// 切换币种划转\nconst onToggleTransfer = () => {\n  transferMap.value = {\n    from: transferMap.value.to,\n    to: transferMap.value.from\n  }\n  transferCoinsAmount.value = ''\n\n  // 更新汇率等信息\n  getUserCoin({})\n}\n\n// 最大划转数量\nconst onMaxAmount = () => {\n  transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2)\n}\n// 确认划转\nconst onSubmit = async () => {\n  if (!transferCoinsAmount.value) {\n    showToast({\n      message: '请输入划转数量',\n      icon: info,\n      iconSize: '48px'\n    })\n    return\n  }\n\n  if (+transferCoinsAmount.value < +minTransferAmount.value) {\n    showToast({\n      message: '输入的数量小于最小划转数量',\n      icon: info,\n      iconSize: '48px'\n    })\n    return\n  }\n\n  try {\n    const res = await getMoneyExchargeApi({\n      num: transferCoinsAmount.value,\n      mtype: transferMap.value.from.mtype,\n      coin_name: coinInfo.value!.coin_name,\n      to_mtype: transferMap.value.to.mtype,\n      to_coin_name: toCoinInfo.value!.coin_name\n    })\n\n    if (res['code'] === 0) {\n      showToast({\n        message: '成功',\n        icon: success,\n        iconSize: '48px'\n      })\n      transferCoinsAmount.value = ''\n      getUserCoin({})\n    }\n\n    inputAmount.value?.focus()\n  } catch (error) {\n    console.error(error)\n  }\n}\n\n// 初始化提币输入框绑定事件\nconst initAmountEvent = () => {\n  nextTick(() => {\n    // 提币输入框禁止输入特定字符\n    const amountInputEl = document.querySelector('.amount-input input') as HTMLInputElement\n    if (amountInputEl) {\n      amountInputEl.onkeydown = e => {\n        if (['-', '+'].includes(e.key)) {\n          return e.preventDefault()\n        }\n      }\n    }\n  })\n}\n\nonMounted(() => {\n  getUserCoin({})\n  initAmountEvent()\n})\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_van_field = _resolveComponent(\"van-field\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _hoisted_4,\n        _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8 /* PROPS */, _hoisted_5),\n        _hoisted_6\n      ]),\n      _createElementVNode(\"div\", {\n        class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? 'flex-col' : 'flex-col-reverse'])\n      }, [\n        _createElementVNode(\"div\", _hoisted_7, [\n          _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8 /* PROPS */, _hoisted_8),\n          _hoisted_9\n        ]),\n        _createElementVNode(\"div\", _hoisted_10, [\n          _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8 /* PROPS */, _hoisted_11),\n          _hoisted_12\n        ])\n      ], 2 /* CLASS */),\n      _createElementVNode(\"div\", _hoisted_13, [\n        _createElementVNode(\"img\", {\n          src: _unref(transfer02),\n          class: \"icon-transfer\",\n          onClick: onToggleTransfer\n        }, null, 8 /* PROPS */, _hoisted_14)\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_15, [\n      _hoisted_16,\n      _createElementVNode(\"div\", _hoisted_17, [\n        _createCommentVNode(\" 允许输入数字，调起带符号的纯数字键盘 \"),\n        _createVNode(_component_van_field, {\n          modelValue: transferCoinsAmount.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((transferCoinsAmount).value = $event)),\n          ref_key: \"inputAmount\",\n          ref: inputAmount,\n          type: \"number\",\n          placeholder: \"请输入划转数量\",\n          class: \"amount-input\"\n        }, null, 8 /* PROPS */, [\"modelValue\"]),\n        _createElementVNode(\"div\", _hoisted_18, _toDisplayString(transferMap.value.from.unit), 1 /* TEXT */),\n        _createElementVNode(\"div\", {\n          class: \"max-amount\",\n          onClick: onMaxAmount\n        }, \" 全部 \")\n      ]),\n      _createElementVNode(\"div\", _hoisted_19, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(transferCoinsInfo.value, (item, index) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: index,\n            class: \"row-item flex justify-between items-center\"\n          }, [\n            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(item.label), 1 /* TEXT */),\n            _createElementVNode(\"div\", _hoisted_21, [\n              (index === 2)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, _toDisplayString(`1 ${transferMap.value.from.unit} ≈ ${item.value}`), 1 /* TEXT */))\n                : (_openBlock(), _createElementBlock(\"span\", {\n                    key: 1,\n                    class: _normalizeClass([\"amount\", { 'amount-bold': index === 0 }])\n                  }, _toDisplayString(item.value), 3 /* TEXT, CLASS */)),\n              _createElementVNode(\"span\", _hoisted_23, _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit), 1 /* TEXT */)\n            ])\n          ]))\n        }), 128 /* KEYED_FRAGMENT */))\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      class: \"btn-submit text-center\",\n      onClick: onSubmit\n    }, \" 确认划转 \")\n  ]))\n}\n}\n\n})",
      "start": 1714699769953,
      "end": 1714699769953
    },
    {
      "name": "vite:css",
      "start": 1714699769953,
      "end": 1714699769953,
      "order": "normal"
    },
    {
      "name": "vite:esbuild",
      "result": "import { defineComponent as _defineComponent } from \"vue\";\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = (n) => (_pushScopeId(\"data-v-b1484c1a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" };\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" };\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" };\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"从\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"到\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_7 = { class: \"row-item flex items-center\" };\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"矿工币\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_10 = { class: \"row-item flex items-center\" };\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"USDT泰达币\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_13 = { class: \"self-center\" };\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = { class: \"transfer-info-container\" };\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  { class: \"amount-text\" },\n  \"划转数量\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" };\nconst _hoisted_18 = { class: \"coin-unit\" };\nconst _hoisted_19 = { class: \"item-info-container\" };\nconst _hoisted_20 = { class: \"label\" };\nconst _hoisted_21 = { class: \"value flex items-center\" };\nconst _hoisted_22 = { key: 0 };\nconst _hoisted_23 = { class: \"unit\" };\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport transfer01 from \"@/assets/images/bricks/transfer01.png\";\nimport transfer02 from \"@/assets/images/bricks/transfer02.png\";\nimport KGB01 from \"@/assets/images/bricks/KGB01.png\";\nimport USDT01 from \"@/assets/images/bricks/USDT01.png\";\nimport { useAuthStore } from \"@/store\";\nimport { storeToRefs } from \"pinia\";\nimport { showToast } from \"vant\";\nimport info from \"@/assets/images/common/info.png\";\nimport success from \"@/assets/images/common/success.png\";\nimport { getMoneyExchargeApi } from \"@/apis/user\";\nexport default /* @__PURE__ */ _defineComponent({\n  __name: \"Transfer\",\n  setup(__props) {\n    const authStore = useAuthStore();\n    const { getUserCoin } = authStore;\n    const { coins } = storeToRefs(authStore);\n    const route = useRoute();\n    const routeParamsMap = {\n      \"kgb-to-usdt\": {\n        mtype: 30,\n        unit: \"CNY\"\n      },\n      \"usdt-to-kgb\": {\n        mtype: 2,\n        unit: \"USDT\"\n      }\n    };\n    const [from, to] = route.params.coin.split(\"-to-\");\n    const transferMap = ref({\n      from: routeParamsMap[from + \"-to-\" + to],\n      to: routeParamsMap[to + \"-to-\" + from]\n    });\n    const transferCoinsInfo = ref([\n      { label: \"可用金额\", value: \"0.00\" },\n      { label: \"手续费(0%)\", value: \"0.00\" },\n      { label: \"当前汇率\", value: \"0.00\" },\n      { label: \"划转获得\", value: \"0.00\" },\n      { label: \"最小划转数量\", value: \"0.00\" }\n    ]);\n    const transferCoinsAmount = ref(\"\");\n    const inputAmount = ref();\n    const coinInfo = computed(\n      () => coins.value?.find((item) => item.mtype === transferMap.value.from.mtype)\n    );\n    const toCoinInfo = computed(\n      () => coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)\n    );\n    const currExchangeRate = computed(() => {\n      const fromCoinPrice = +(coinInfo.value?.coinset_config?.coin_price || 0);\n      const toCoinPrice = +(coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)?.coinset_config?.coin_price || 1);\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\n    });\n    const minTransferAmount = computed(() => {\n      if (!coinInfo.value?.coinset_config)\n        return \"0.00\";\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\n    });\n    const maxAvailableTransfer = computed(\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\n    );\n    const updateCursorPos = (onlyUpdateValue = false) => {\n      setTimeout(() => {\n        let amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.value = transferCoinsAmount.value;\n          if (onlyUpdateValue) {\n            amountInputEl = null;\n            return;\n          }\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\n          amountInputEl = null;\n        }\n      }, 20);\n    };\n    watch(transferCoinsAmount, (val, oldVal) => {\n      if (val === \".\" || val.startsWith(\"00\")) {\n        transferCoinsAmount.value = \"0.\";\n        updateCursorPos();\n        return;\n      }\n      if (oldVal && val.startsWith(\"0\")) {\n        transferCoinsAmount.value = \"0\";\n      }\n      const dotIndex = val.indexOf(\".\");\n      if (~dotIndex) {\n        const str = val.slice(dotIndex + 1, val.length);\n        const replacer = (match, p1, p2) => {\n          if (p1.startsWith(\"0\") && +p1 > 0) {\n            return \"0\";\n          }\n          return p1 + \".\" + p2;\n        };\n        const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer);\n        transferCoinsAmount.value = newAmount;\n        updateCursorPos(true);\n        return;\n      }\n      if (+val > +maxAvailableTransfer.value) {\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n        updateCursorPos();\n      }\n    });\n    watchEffect(() => {\n      const swaptoFeeRate = +(coinInfo.value?.coinset_config?.swapto_fee || 0);\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n        2\n      );\n      transferCoinsInfo.value = [\n        { label: \"可用金额\", value: availableCoincash },\n        {\n          label: `手续费(${swaptoFeeRate * 100}%)`,\n          value: swaptoFee\n        },\n        {\n          label: \"当前汇率\",\n          value: currExchangeRate.value\n        },\n        {\n          label: \"划转获得\",\n          value: finalCoincash\n        },\n        {\n          label: \"最小划转数量\",\n          value: minTransferAmount.value\n        }\n      ];\n    });\n    const onToggleTransfer = () => {\n      transferMap.value = {\n        from: transferMap.value.to,\n        to: transferMap.value.from\n      };\n      transferCoinsAmount.value = \"\";\n      getUserCoin({});\n    };\n    const onMaxAmount = () => {\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n    };\n    const onSubmit = async () => {\n      if (!transferCoinsAmount.value) {\n        showToast({\n          message: \"请输入划转数量\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\n        showToast({\n          message: \"输入的数量小于最小划转数量\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      try {\n        const res = await getMoneyExchargeApi({\n          num: transferCoinsAmount.value,\n          mtype: transferMap.value.from.mtype,\n          coin_name: coinInfo.value.coin_name,\n          to_mtype: transferMap.value.to.mtype,\n          to_coin_name: toCoinInfo.value.coin_name\n        });\n        if (res[\"code\"] === 0) {\n          showToast({\n            message: \"成功\",\n            icon: success,\n            iconSize: \"48px\"\n          });\n          transferCoinsAmount.value = \"\";\n          getUserCoin({});\n        }\n        inputAmount.value?.focus();\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    const initAmountEvent = () => {\n      nextTick(() => {\n        const amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.onkeydown = (e) => {\n            if ([\"-\", \"+\"].includes(e.key)) {\n              return e.preventDefault();\n            }\n          };\n        }\n      });\n    };\n    onMounted(() => {\n      getUserCoin({});\n      initAmountEvent();\n    });\n    return (_ctx, _cache) => {\n      const _component_van_field = _resolveComponent(\"van-field\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\n            _hoisted_6\n          ]),\n          _createElementVNode(\n            \"div\",\n            {\n              class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? \"flex-col\" : \"flex-col-reverse\"])\n            },\n            [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\n                _hoisted_9\n              ]),\n              _createElementVNode(\"div\", _hoisted_10, [\n                _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\n                _hoisted_12\n              ])\n            ],\n            2\n            /* CLASS */\n          ),\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"img\", {\n              src: _unref(transfer02),\n              class: \"icon-transfer\",\n              onClick: onToggleTransfer\n            }, null, 8, _hoisted_14)\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _hoisted_16,\n          _createElementVNode(\"div\", _hoisted_17, [\n            _createCommentVNode(\" 允许输入数字，调起带符号的纯数字键盘 \"),\n            _createVNode(_component_van_field, {\n              modelValue: transferCoinsAmount.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\n              ref_key: \"inputAmount\",\n              ref: inputAmount,\n              type: \"number\",\n              placeholder: \"请输入划转数量\",\n              class: \"amount-input\"\n            }, null, 8, [\"modelValue\"]),\n            _createElementVNode(\n              \"div\",\n              _hoisted_18,\n              _toDisplayString(transferMap.value.from.unit),\n              1\n              /* TEXT */\n            ),\n            _createElementVNode(\"div\", {\n              class: \"max-amount\",\n              onClick: onMaxAmount\n            }, \" 全部 \")\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            (_openBlock(true), _createElementBlock(\n              _Fragment,\n              null,\n              _renderList(transferCoinsInfo.value, (item, index) => {\n                return _openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"row-item flex justify-between items-center\"\n                }, [\n                  _createElementVNode(\n                    \"div\",\n                    _hoisted_20,\n                    _toDisplayString(item.label),\n                    1\n                    /* TEXT */\n                  ),\n                  _createElementVNode(\"div\", _hoisted_21, [\n                    index === 2 ? (_openBlock(), _createElementBlock(\n                      \"span\",\n                      _hoisted_22,\n                      _toDisplayString(`1 ${transferMap.value.from.unit} ≈ ${item.value}`),\n                      1\n                      /* TEXT */\n                    )) : (_openBlock(), _createElementBlock(\n                      \"span\",\n                      {\n                        key: 1,\n                        class: _normalizeClass([\"amount\", { \"amount-bold\": index === 0 }])\n                      },\n                      _toDisplayString(item.value),\n                      3\n                      /* TEXT, CLASS */\n                    )),\n                    _createElementVNode(\n                      \"span\",\n                      _hoisted_23,\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\n                      1\n                      /* TEXT */\n                    )\n                  ])\n                ]);\n              }),\n              128\n              /* KEYED_FRAGMENT */\n            ))\n          ])\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"btn-submit text-center\",\n          onClick: onSubmit\n        }, \" 确认划转 \")\n      ]);\n    };\n  }\n});\n",
      "start": 1714699769954,
      "end": 1714699770698,
      "order": "normal",
      "sourcemaps": {
        "version": 3,
        "sources": [
          "/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Bricks/Transfer.vue?vue&type=script&setup=true&lang.ts"
        ],
        "sourcesContent": [
          "import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-b1484c1a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" }\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" }\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"从\", -1 /* HOISTED */))\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"到\", -1 /* HOISTED */))\nconst _hoisted_7 = { class: \"row-item flex items-center\" }\nconst _hoisted_8 = [\"src\"]\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"矿工币\", -1 /* HOISTED */))\nconst _hoisted_10 = { class: \"row-item flex items-center\" }\nconst _hoisted_11 = [\"src\"]\nconst _hoisted_12 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"USDT泰达币\", -1 /* HOISTED */))\nconst _hoisted_13 = { class: \"self-center\" }\nconst _hoisted_14 = [\"src\"]\nconst _hoisted_15 = { class: \"transfer-info-container\" }\nconst _hoisted_16 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"amount-text\" }, \"划转数量\", -1 /* HOISTED */))\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" }\nconst _hoisted_18 = { class: \"coin-unit\" }\nconst _hoisted_19 = { class: \"item-info-container\" }\nconst _hoisted_20 = { class: \"label\" }\nconst _hoisted_21 = { class: \"value flex items-center\" }\nconst _hoisted_22 = { key: 0 }\nconst _hoisted_23 = { class: \"unit\" }\n\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from 'vue'\nimport { useRoute } from 'vue-router'\nimport transfer01 from '@/assets/images/bricks/transfer01.png'\nimport transfer02 from '@/assets/images/bricks/transfer02.png'\nimport KGB01 from '@/assets/images/bricks/KGB01.png'\nimport USDT01 from '@/assets/images/bricks/USDT01.png'\nimport { useAuthStore } from '@/store'\nimport { storeToRefs } from 'pinia'\nimport { showToast } from 'vant'\nimport info from '@/assets/images/common/info.png'\nimport success from '@/assets/images/common/success.png'\nimport { getMoneyExchargeApi } from '@/apis/user'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Transfer',\n  setup(__props) {\n\nconst authStore = useAuthStore()\nconst { getUserCoin } = authStore\nconst { coins } = storeToRefs(authStore)\n\nconst route = useRoute()\n\n// 路由参数对应划转币种映射表\nconst routeParamsMap = {\n  'kgb-to-usdt': {\n    mtype: 30,\n    unit: 'CNY'\n  },\n  'usdt-to-kgb': {\n    mtype: 2,\n    unit: 'USDT'\n  }\n} as Record<string, any>\n\nconst [from, to] = (route.params.coin as string).split('-to-')\n\n// 币种划转映射表\nconst transferMap = ref({\n  from: routeParamsMap[from + '-to-' + to],\n  to: routeParamsMap[to + '-to-' + from]\n})\n// 划转条目信息\nconst transferCoinsInfo = ref([\n  { label: '可用金额', value: '0.00' },\n  { label: '手续费(0%)', value: '0.00' },\n  { label: '当前汇率', value: '0.00' },\n  { label: '划转获得', value: '0.00' },\n  { label: '最小划转数量', value: '0.00' }\n])\n// 划转数量\nconst transferCoinsAmount = ref('')\nconst inputAmount = ref()\n\n// 币种信息\nconst coinInfo = computed(() =>\n  coins.value?.find(item => item.mtype === transferMap.value.from.mtype)\n)\n// 转换目标币种信息\nconst toCoinInfo = computed(() =>\n  coins.value?.find(item => item.mtype === transferMap.value.to.mtype)\n)\n// 当前汇率\nconst currExchangeRate = computed(() => {\n  const fromCoinPrice = +(coinInfo.value?.coinset_config?.coin_price || 0)\n  const toCoinPrice = +(\n    coins.value?.find(item => item.mtype === transferMap.value.to.mtype)?.coinset_config\n      ?.coin_price || 1\n  )\n\n  return (fromCoinPrice / toCoinPrice).toTruncFixed(3)\n})\n// 最小划转数量\nconst minTransferAmount = computed(() => {\n  if (!coinInfo.value?.coinset_config) return '0.00'\n\n  return (\n    +coinInfo.value!.coinset_config!.min_swapto / +coinInfo.value!.coinset_config!.coin_price\n  ).toTruncFixed(2)\n})\n// 最大可划转数量(扣减手续费后)\nconst maxAvailableTransfer = computed(\n  () => +coinInfo.value!.available_coincash / (1 + +coinInfo.value!.coinset_config!.swapto_fee)\n)\n\n// 修正光标位置\nconst updateCursorPos = (onlyUpdateValue = false) => {\n  setTimeout(() => {\n    let amountInputEl = document.querySelector('.amount-input input') as HTMLInputElement\n\n    if (amountInputEl) {\n      amountInputEl.value = transferCoinsAmount.value\n\n      if (onlyUpdateValue) {\n        // 释放dom引用\n        amountInputEl = null as any\n        return\n      }\n\n      // 光标开始处\n      amountInputEl.selectionStart = transferCoinsAmount.value.length\n      // 光标结束处\n      amountInputEl.selectionEnd = transferCoinsAmount.value.length\n      // 释放dom引用\n      amountInputEl = null as any\n    }\n  }, 20)\n}\n\n// 输入内容修正\nwatch(transferCoinsAmount, (val, oldVal) => {\n  // 小数点开头，自动补齐0.\n  if (val === '.' || val.startsWith('00')) {\n    transferCoinsAmount.value = '0.'\n    updateCursorPos()\n    return\n  }\n\n  // 00开头变为0\n  if (oldVal && val.startsWith('0')) {\n    transferCoinsAmount.value = '0'\n  }\n\n  // 小数位数保留2位\n  const dotIndex = val.indexOf('.')\n  if (~dotIndex) {\n    const str = val.slice(dotIndex + 1, val.length)\n    const replacer = (match: string, p1: string, p2: string) => {\n      if (p1.startsWith('0') && +p1 > 0) {\n        return '0'\n      }\n      return p1 + '.' + p2\n    }\n    const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer)\n\n    transferCoinsAmount.value = newAmount\n    updateCursorPos(true)\n    return\n  }\n\n  // 提币输入超过最大提币数量时，变为最大可提币输入\n  if (+val > +maxAvailableTransfer.value) {\n    transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2)\n    updateCursorPos()\n  }\n})\n\n// 更新划转相关条目配置数据\nwatchEffect(() => {\n  // 手续费费率\n  const swaptoFeeRate = +(coinInfo.value?.coinset_config?.swapto_fee || 0)\n  // 手续费\n  const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2)\n  // 可用金额\n  const availableCoincash = (+coinInfo.value!.available_coincash).toTruncFixed(2)\n  // 划转获得\n  const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n    2\n  )\n\n  transferCoinsInfo.value = [\n    { label: '可用金额', value: availableCoincash },\n    {\n      label: `手续费(${swaptoFeeRate * 100}%)`,\n      value: swaptoFee\n    },\n    {\n      label: '当前汇率',\n      value: currExchangeRate.value\n    },\n    {\n      label: '划转获得',\n      value: finalCoincash\n    },\n    {\n      label: '最小划转数量',\n      value: minTransferAmount.value\n    }\n  ]\n})\n\n// 切换币种划转\nconst onToggleTransfer = () => {\n  transferMap.value = {\n    from: transferMap.value.to,\n    to: transferMap.value.from\n  }\n  transferCoinsAmount.value = ''\n\n  // 更新汇率等信息\n  getUserCoin({})\n}\n\n// 最大划转数量\nconst onMaxAmount = () => {\n  transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2)\n}\n// 确认划转\nconst onSubmit = async () => {\n  if (!transferCoinsAmount.value) {\n    showToast({\n      message: '请输入划转数量',\n      icon: info,\n      iconSize: '48px'\n    })\n    return\n  }\n\n  if (+transferCoinsAmount.value < +minTransferAmount.value) {\n    showToast({\n      message: '输入的数量小于最小划转数量',\n      icon: info,\n      iconSize: '48px'\n    })\n    return\n  }\n\n  try {\n    const res = await getMoneyExchargeApi({\n      num: transferCoinsAmount.value,\n      mtype: transferMap.value.from.mtype,\n      coin_name: coinInfo.value!.coin_name,\n      to_mtype: transferMap.value.to.mtype,\n      to_coin_name: toCoinInfo.value!.coin_name\n    })\n\n    if (res['code'] === 0) {\n      showToast({\n        message: '成功',\n        icon: success,\n        iconSize: '48px'\n      })\n      transferCoinsAmount.value = ''\n      getUserCoin({})\n    }\n\n    inputAmount.value?.focus()\n  } catch (error) {\n    console.error(error)\n  }\n}\n\n// 初始化提币输入框绑定事件\nconst initAmountEvent = () => {\n  nextTick(() => {\n    // 提币输入框禁止输入特定字符\n    const amountInputEl = document.querySelector('.amount-input input') as HTMLInputElement\n    if (amountInputEl) {\n      amountInputEl.onkeydown = e => {\n        if (['-', '+'].includes(e.key)) {\n          return e.preventDefault()\n        }\n      }\n    }\n  })\n}\n\nonMounted(() => {\n  getUserCoin({})\n  initAmountEvent()\n})\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_van_field = _resolveComponent(\"van-field\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _hoisted_4,\n        _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8 /* PROPS */, _hoisted_5),\n        _hoisted_6\n      ]),\n      _createElementVNode(\"div\", {\n        class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? 'flex-col' : 'flex-col-reverse'])\n      }, [\n        _createElementVNode(\"div\", _hoisted_7, [\n          _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8 /* PROPS */, _hoisted_8),\n          _hoisted_9\n        ]),\n        _createElementVNode(\"div\", _hoisted_10, [\n          _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8 /* PROPS */, _hoisted_11),\n          _hoisted_12\n        ])\n      ], 2 /* CLASS */),\n      _createElementVNode(\"div\", _hoisted_13, [\n        _createElementVNode(\"img\", {\n          src: _unref(transfer02),\n          class: \"icon-transfer\",\n          onClick: onToggleTransfer\n        }, null, 8 /* PROPS */, _hoisted_14)\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_15, [\n      _hoisted_16,\n      _createElementVNode(\"div\", _hoisted_17, [\n        _createCommentVNode(\" 允许输入数字，调起带符号的纯数字键盘 \"),\n        _createVNode(_component_van_field, {\n          modelValue: transferCoinsAmount.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((transferCoinsAmount).value = $event)),\n          ref_key: \"inputAmount\",\n          ref: inputAmount,\n          type: \"number\",\n          placeholder: \"请输入划转数量\",\n          class: \"amount-input\"\n        }, null, 8 /* PROPS */, [\"modelValue\"]),\n        _createElementVNode(\"div\", _hoisted_18, _toDisplayString(transferMap.value.from.unit), 1 /* TEXT */),\n        _createElementVNode(\"div\", {\n          class: \"max-amount\",\n          onClick: onMaxAmount\n        }, \" 全部 \")\n      ]),\n      _createElementVNode(\"div\", _hoisted_19, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(transferCoinsInfo.value, (item, index) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: index,\n            class: \"row-item flex justify-between items-center\"\n          }, [\n            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(item.label), 1 /* TEXT */),\n            _createElementVNode(\"div\", _hoisted_21, [\n              (index === 2)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_22, _toDisplayString(`1 ${transferMap.value.from.unit} ≈ ${item.value}`), 1 /* TEXT */))\n                : (_openBlock(), _createElementBlock(\"span\", {\n                    key: 1,\n                    class: _normalizeClass([\"amount\", { 'amount-bold': index === 0 }])\n                  }, _toDisplayString(item.value), 3 /* TEXT, CLASS */)),\n              _createElementVNode(\"span\", _hoisted_23, _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit), 1 /* TEXT */)\n            ])\n          ]))\n        }), 128 /* KEYED_FRAGMENT */))\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      class: \"btn-submit text-center\",\n      onClick: onSubmit\n    }, \" 确认划转 \")\n  ]))\n}\n}\n\n})"
        ],
        "mappings": "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",
        "names": []
      }
    },
    {
      "name": "vite:json",
      "start": 1714699770698,
      "end": 1714699770698,
      "order": "normal"
    },
    {
      "name": "vite:worker",
      "start": 1714699770698,
      "end": 1714699770698,
      "order": "normal"
    },
    {
      "name": "vite:vue",
      "start": 1714699770698,
      "end": 1714699770698,
      "order": "normal"
    },
    {
      "name": "vite:vue-jsx",
      "start": 1714699770698,
      "end": 1714699770698,
      "order": "normal"
    },
    {
      "name": "vite-plugin-vconsole",
      "result": "import { defineComponent as _defineComponent } from \"vue\";\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = (n) => (_pushScopeId(\"data-v-b1484c1a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" };\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" };\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" };\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"从\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"到\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_7 = { class: \"row-item flex items-center\" };\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"矿工币\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_10 = { class: \"row-item flex items-center\" };\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"USDT泰达币\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_13 = { class: \"self-center\" };\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = { class: \"transfer-info-container\" };\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  { class: \"amount-text\" },\n  \"划转数量\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" };\nconst _hoisted_18 = { class: \"coin-unit\" };\nconst _hoisted_19 = { class: \"item-info-container\" };\nconst _hoisted_20 = { class: \"label\" };\nconst _hoisted_21 = { class: \"value flex items-center\" };\nconst _hoisted_22 = { key: 0 };\nconst _hoisted_23 = { class: \"unit\" };\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport transfer01 from \"@/assets/images/bricks/transfer01.png\";\nimport transfer02 from \"@/assets/images/bricks/transfer02.png\";\nimport KGB01 from \"@/assets/images/bricks/KGB01.png\";\nimport USDT01 from \"@/assets/images/bricks/USDT01.png\";\nimport { useAuthStore } from \"@/store\";\nimport { storeToRefs } from \"pinia\";\nimport { showToast } from \"vant\";\nimport info from \"@/assets/images/common/info.png\";\nimport success from \"@/assets/images/common/success.png\";\nimport { getMoneyExchargeApi } from \"@/apis/user\";\nexport default /* @__PURE__ */ _defineComponent({\n  __name: \"Transfer\",\n  setup(__props) {\n    const authStore = useAuthStore();\n    const { getUserCoin } = authStore;\n    const { coins } = storeToRefs(authStore);\n    const route = useRoute();\n    const routeParamsMap = {\n      \"kgb-to-usdt\": {\n        mtype: 30,\n        unit: \"CNY\"\n      },\n      \"usdt-to-kgb\": {\n        mtype: 2,\n        unit: \"USDT\"\n      }\n    };\n    const [from, to] = route.params.coin.split(\"-to-\");\n    const transferMap = ref({\n      from: routeParamsMap[from + \"-to-\" + to],\n      to: routeParamsMap[to + \"-to-\" + from]\n    });\n    const transferCoinsInfo = ref([\n      { label: \"可用金额\", value: \"0.00\" },\n      { label: \"手续费(0%)\", value: \"0.00\" },\n      { label: \"当前汇率\", value: \"0.00\" },\n      { label: \"划转获得\", value: \"0.00\" },\n      { label: \"最小划转数量\", value: \"0.00\" }\n    ]);\n    const transferCoinsAmount = ref(\"\");\n    const inputAmount = ref();\n    const coinInfo = computed(\n      () => coins.value?.find((item) => item.mtype === transferMap.value.from.mtype)\n    );\n    const toCoinInfo = computed(\n      () => coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)\n    );\n    const currExchangeRate = computed(() => {\n      const fromCoinPrice = +(coinInfo.value?.coinset_config?.coin_price || 0);\n      const toCoinPrice = +(coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)?.coinset_config?.coin_price || 1);\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\n    });\n    const minTransferAmount = computed(() => {\n      if (!coinInfo.value?.coinset_config)\n        return \"0.00\";\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\n    });\n    const maxAvailableTransfer = computed(\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\n    );\n    const updateCursorPos = (onlyUpdateValue = false) => {\n      setTimeout(() => {\n        let amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.value = transferCoinsAmount.value;\n          if (onlyUpdateValue) {\n            amountInputEl = null;\n            return;\n          }\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\n          amountInputEl = null;\n        }\n      }, 20);\n    };\n    watch(transferCoinsAmount, (val, oldVal) => {\n      if (val === \".\" || val.startsWith(\"00\")) {\n        transferCoinsAmount.value = \"0.\";\n        updateCursorPos();\n        return;\n      }\n      if (oldVal && val.startsWith(\"0\")) {\n        transferCoinsAmount.value = \"0\";\n      }\n      const dotIndex = val.indexOf(\".\");\n      if (~dotIndex) {\n        const str = val.slice(dotIndex + 1, val.length);\n        const replacer = (match, p1, p2) => {\n          if (p1.startsWith(\"0\") && +p1 > 0) {\n            return \"0\";\n          }\n          return p1 + \".\" + p2;\n        };\n        const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer);\n        transferCoinsAmount.value = newAmount;\n        updateCursorPos(true);\n        return;\n      }\n      if (+val > +maxAvailableTransfer.value) {\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n        updateCursorPos();\n      }\n    });\n    watchEffect(() => {\n      const swaptoFeeRate = +(coinInfo.value?.coinset_config?.swapto_fee || 0);\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n        2\n      );\n      transferCoinsInfo.value = [\n        { label: \"可用金额\", value: availableCoincash },\n        {\n          label: `手续费(${swaptoFeeRate * 100}%)`,\n          value: swaptoFee\n        },\n        {\n          label: \"当前汇率\",\n          value: currExchangeRate.value\n        },\n        {\n          label: \"划转获得\",\n          value: finalCoincash\n        },\n        {\n          label: \"最小划转数量\",\n          value: minTransferAmount.value\n        }\n      ];\n    });\n    const onToggleTransfer = () => {\n      transferMap.value = {\n        from: transferMap.value.to,\n        to: transferMap.value.from\n      };\n      transferCoinsAmount.value = \"\";\n      getUserCoin({});\n    };\n    const onMaxAmount = () => {\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n    };\n    const onSubmit = async () => {\n      if (!transferCoinsAmount.value) {\n        showToast({\n          message: \"请输入划转数量\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\n        showToast({\n          message: \"输入的数量小于最小划转数量\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      try {\n        const res = await getMoneyExchargeApi({\n          num: transferCoinsAmount.value,\n          mtype: transferMap.value.from.mtype,\n          coin_name: coinInfo.value.coin_name,\n          to_mtype: transferMap.value.to.mtype,\n          to_coin_name: toCoinInfo.value.coin_name\n        });\n        if (res[\"code\"] === 0) {\n          showToast({\n            message: \"成功\",\n            icon: success,\n            iconSize: \"48px\"\n          });\n          transferCoinsAmount.value = \"\";\n          getUserCoin({});\n        }\n        inputAmount.value?.focus();\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    const initAmountEvent = () => {\n      nextTick(() => {\n        const amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.onkeydown = (e) => {\n            if ([\"-\", \"+\"].includes(e.key)) {\n              return e.preventDefault();\n            }\n          };\n        }\n      });\n    };\n    onMounted(() => {\n      getUserCoin({});\n      initAmountEvent();\n    });\n    return (_ctx, _cache) => {\n      const _component_van_field = _resolveComponent(\"van-field\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\n            _hoisted_6\n          ]),\n          _createElementVNode(\n            \"div\",\n            {\n              class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? \"flex-col\" : \"flex-col-reverse\"])\n            },\n            [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\n                _hoisted_9\n              ]),\n              _createElementVNode(\"div\", _hoisted_10, [\n                _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\n                _hoisted_12\n              ])\n            ],\n            2\n            /* CLASS */\n          ),\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"img\", {\n              src: _unref(transfer02),\n              class: \"icon-transfer\",\n              onClick: onToggleTransfer\n            }, null, 8, _hoisted_14)\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _hoisted_16,\n          _createElementVNode(\"div\", _hoisted_17, [\n            _createCommentVNode(\" 允许输入数字，调起带符号的纯数字键盘 \"),\n            _createVNode(_component_van_field, {\n              modelValue: transferCoinsAmount.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\n              ref_key: \"inputAmount\",\n              ref: inputAmount,\n              type: \"number\",\n              placeholder: \"请输入划转数量\",\n              class: \"amount-input\"\n            }, null, 8, [\"modelValue\"]),\n            _createElementVNode(\n              \"div\",\n              _hoisted_18,\n              _toDisplayString(transferMap.value.from.unit),\n              1\n              /* TEXT */\n            ),\n            _createElementVNode(\"div\", {\n              class: \"max-amount\",\n              onClick: onMaxAmount\n            }, \" 全部 \")\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            (_openBlock(true), _createElementBlock(\n              _Fragment,\n              null,\n              _renderList(transferCoinsInfo.value, (item, index) => {\n                return _openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"row-item flex justify-between items-center\"\n                }, [\n                  _createElementVNode(\n                    \"div\",\n                    _hoisted_20,\n                    _toDisplayString(item.label),\n                    1\n                    /* TEXT */\n                  ),\n                  _createElementVNode(\"div\", _hoisted_21, [\n                    index === 2 ? (_openBlock(), _createElementBlock(\n                      \"span\",\n                      _hoisted_22,\n                      _toDisplayString(`1 ${transferMap.value.from.unit} ≈ ${item.value}`),\n                      1\n                      /* TEXT */\n                    )) : (_openBlock(), _createElementBlock(\n                      \"span\",\n                      {\n                        key: 1,\n                        class: _normalizeClass([\"amount\", { \"amount-bold\": index === 0 }])\n                      },\n                      _toDisplayString(item.value),\n                      3\n                      /* TEXT, CLASS */\n                    )),\n                    _createElementVNode(\n                      \"span\",\n                      _hoisted_23,\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\n                      1\n                      /* TEXT */\n                    )\n                  ])\n                ]);\n              }),\n              128\n              /* KEYED_FRAGMENT */\n            ))\n          ])\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"btn-submit text-center\",\n          onClick: onSubmit\n        }, \" 确认划转 \")\n      ]);\n    };\n  }\n});\n",
      "start": 1714699770698,
      "end": 1714699770698,
      "order": "normal",
      "sourcemaps": null
    },
    {
      "name": "esbuild",
      "result": "\"use strict\";\nimport { defineComponent as _defineComponent } from \"vue\";\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = (n) => (_pushScopeId(\"data-v-b1484c1a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" };\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" };\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" };\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u4ECE\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u5230\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_7 = { class: \"row-item flex items-center\" };\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u77FF\\u5DE5\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_10 = { class: \"row-item flex items-center\" };\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"USDT\\u6CF0\\u8FBE\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_13 = { class: \"self-center\" };\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = { class: \"transfer-info-container\" };\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  { class: \"amount-text\" },\n  \"\\u5212\\u8F6C\\u6570\\u91CF\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" };\nconst _hoisted_18 = { class: \"coin-unit\" };\nconst _hoisted_19 = { class: \"item-info-container\" };\nconst _hoisted_20 = { class: \"label\" };\nconst _hoisted_21 = { class: \"value flex items-center\" };\nconst _hoisted_22 = { key: 0 };\nconst _hoisted_23 = { class: \"unit\" };\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport transfer01 from \"@/assets/images/bricks/transfer01.png\";\nimport transfer02 from \"@/assets/images/bricks/transfer02.png\";\nimport KGB01 from \"@/assets/images/bricks/KGB01.png\";\nimport USDT01 from \"@/assets/images/bricks/USDT01.png\";\nimport { useAuthStore } from \"@/store\";\nimport { storeToRefs } from \"pinia\";\nimport { showToast } from \"vant\";\nimport info from \"@/assets/images/common/info.png\";\nimport success from \"@/assets/images/common/success.png\";\nimport { getMoneyExchargeApi } from \"@/apis/user\";\nexport default /* @__PURE__ */ _defineComponent({\n  __name: \"Transfer\",\n  setup(__props) {\n    const authStore = useAuthStore();\n    const { getUserCoin } = authStore;\n    const { coins } = storeToRefs(authStore);\n    const route = useRoute();\n    const routeParamsMap = {\n      \"kgb-to-usdt\": {\n        mtype: 30,\n        unit: \"CNY\"\n      },\n      \"usdt-to-kgb\": {\n        mtype: 2,\n        unit: \"USDT\"\n      }\n    };\n    const [from, to] = route.params.coin.split(\"-to-\");\n    const transferMap = ref({\n      from: routeParamsMap[from + \"-to-\" + to],\n      to: routeParamsMap[to + \"-to-\" + from]\n    });\n    const transferCoinsInfo = ref([\n      { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: \"0.00\" },\n      { label: \"\\u624B\\u7EED\\u8D39(0%)\", value: \"0.00\" },\n      { label: \"\\u5F53\\u524D\\u6C47\\u7387\", value: \"0.00\" },\n      { label: \"\\u5212\\u8F6C\\u83B7\\u5F97\", value: \"0.00\" },\n      { label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\", value: \"0.00\" }\n    ]);\n    const transferCoinsAmount = ref(\"\");\n    const inputAmount = ref();\n    const coinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.from.mtype);\n      }\n    );\n    const toCoinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.to.mtype);\n      }\n    );\n    const currExchangeRate = computed(() => {\n      var _a, _b, _c, _d, _e;\n      const fromCoinPrice = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.coin_price) || 0);\n      const toCoinPrice = +(((_e = (_d = (_c = coins.value) == null ? void 0 : _c.find((item) => item.mtype === transferMap.value.to.mtype)) == null ? void 0 : _d.coinset_config) == null ? void 0 : _e.coin_price) || 1);\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\n    });\n    const minTransferAmount = computed(() => {\n      var _a;\n      if (!((_a = coinInfo.value) == null ? void 0 : _a.coinset_config))\n        return \"0.00\";\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\n    });\n    const maxAvailableTransfer = computed(\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\n    );\n    const updateCursorPos = (onlyUpdateValue = false) => {\n      setTimeout(() => {\n        let amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.value = transferCoinsAmount.value;\n          if (onlyUpdateValue) {\n            amountInputEl = null;\n            return;\n          }\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\n          amountInputEl = null;\n        }\n      }, 20);\n    };\n    watch(transferCoinsAmount, (val, oldVal) => {\n      if (val === \".\" || val.startsWith(\"00\")) {\n        transferCoinsAmount.value = \"0.\";\n        updateCursorPos();\n        return;\n      }\n      if (oldVal && val.startsWith(\"0\")) {\n        transferCoinsAmount.value = \"0\";\n      }\n      const dotIndex = val.indexOf(\".\");\n      if (~dotIndex) {\n        const str = val.slice(dotIndex + 1, val.length);\n        const replacer = (match, p1, p2) => {\n          if (p1.startsWith(\"0\") && +p1 > 0) {\n            return \"0\";\n          }\n          return p1 + \".\" + p2;\n        };\n        const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer);\n        transferCoinsAmount.value = newAmount;\n        updateCursorPos(true);\n        return;\n      }\n      if (+val > +maxAvailableTransfer.value) {\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n        updateCursorPos();\n      }\n    });\n    watchEffect(() => {\n      var _a, _b;\n      const swaptoFeeRate = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.swapto_fee) || 0);\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n        2\n      );\n      transferCoinsInfo.value = [\n        { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: availableCoincash },\n        {\n          label: `\\u624B\\u7EED\\u8D39(${swaptoFeeRate * 100}%)`,\n          value: swaptoFee\n        },\n        {\n          label: \"\\u5F53\\u524D\\u6C47\\u7387\",\n          value: currExchangeRate.value\n        },\n        {\n          label: \"\\u5212\\u8F6C\\u83B7\\u5F97\",\n          value: finalCoincash\n        },\n        {\n          label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          value: minTransferAmount.value\n        }\n      ];\n    });\n    const onToggleTransfer = () => {\n      transferMap.value = {\n        from: transferMap.value.to,\n        to: transferMap.value.from\n      };\n      transferCoinsAmount.value = \"\";\n      getUserCoin({});\n    };\n    const onMaxAmount = () => {\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n    };\n    const onSubmit = async () => {\n      var _a;\n      if (!transferCoinsAmount.value) {\n        showToast({\n          message: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\n        showToast({\n          message: \"\\u8F93\\u5165\\u7684\\u6570\\u91CF\\u5C0F\\u4E8E\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      try {\n        const res = await getMoneyExchargeApi({\n          num: transferCoinsAmount.value,\n          mtype: transferMap.value.from.mtype,\n          coin_name: coinInfo.value.coin_name,\n          to_mtype: transferMap.value.to.mtype,\n          to_coin_name: toCoinInfo.value.coin_name\n        });\n        if (res[\"code\"] === 0) {\n          showToast({\n            message: \"\\u6210\\u529F\",\n            icon: success,\n            iconSize: \"48px\"\n          });\n          transferCoinsAmount.value = \"\";\n          getUserCoin({});\n        }\n        (_a = inputAmount.value) == null ? void 0 : _a.focus();\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    const initAmountEvent = () => {\n      nextTick(() => {\n        const amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.onkeydown = (e) => {\n            if ([\"-\", \"+\"].includes(e.key)) {\n              return e.preventDefault();\n            }\n          };\n        }\n      });\n    };\n    onMounted(() => {\n      getUserCoin({});\n      initAmountEvent();\n    });\n    return (_ctx, _cache) => {\n      const _component_van_field = _resolveComponent(\"van-field\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\n            _hoisted_6\n          ]),\n          _createElementVNode(\n            \"div\",\n            {\n              class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? \"flex-col\" : \"flex-col-reverse\"])\n            },\n            [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\n                _hoisted_9\n              ]),\n              _createElementVNode(\"div\", _hoisted_10, [\n                _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\n                _hoisted_12\n              ])\n            ],\n            2\n            /* CLASS */\n          ),\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"img\", {\n              src: _unref(transfer02),\n              class: \"icon-transfer\",\n              onClick: onToggleTransfer\n            }, null, 8, _hoisted_14)\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _hoisted_16,\n          _createElementVNode(\"div\", _hoisted_17, [\n            _createCommentVNode(\" \\u5141\\u8BB8\\u8F93\\u5165\\u6570\\u5B57\\uFF0C\\u8C03\\u8D77\\u5E26\\u7B26\\u53F7\\u7684\\u7EAF\\u6570\\u5B57\\u952E\\u76D8 \"),\n            _createVNode(_component_van_field, {\n              modelValue: transferCoinsAmount.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\n              ref_key: \"inputAmount\",\n              ref: inputAmount,\n              type: \"number\",\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n              class: \"amount-input\"\n            }, null, 8, [\"modelValue\"]),\n            _createElementVNode(\n              \"div\",\n              _hoisted_18,\n              _toDisplayString(transferMap.value.from.unit),\n              1\n              /* TEXT */\n            ),\n            _createElementVNode(\"div\", {\n              class: \"max-amount\",\n              onClick: onMaxAmount\n            }, \" \\u5168\\u90E8 \")\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            (_openBlock(true), _createElementBlock(\n              _Fragment,\n              null,\n              _renderList(transferCoinsInfo.value, (item, index) => {\n                return _openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"row-item flex justify-between items-center\"\n                }, [\n                  _createElementVNode(\n                    \"div\",\n                    _hoisted_20,\n                    _toDisplayString(item.label),\n                    1\n                    /* TEXT */\n                  ),\n                  _createElementVNode(\"div\", _hoisted_21, [\n                    index === 2 ? (_openBlock(), _createElementBlock(\n                      \"span\",\n                      _hoisted_22,\n                      _toDisplayString(`1 ${transferMap.value.from.unit} \\u2248 ${item.value}`),\n                      1\n                      /* TEXT */\n                    )) : (_openBlock(), _createElementBlock(\n                      \"span\",\n                      {\n                        key: 1,\n                        class: _normalizeClass([\"amount\", { \"amount-bold\": index === 0 }])\n                      },\n                      _toDisplayString(item.value),\n                      3\n                      /* TEXT, CLASS */\n                    )),\n                    _createElementVNode(\n                      \"span\",\n                      _hoisted_23,\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\n                      1\n                      /* TEXT */\n                    )\n                  ])\n                ]);\n              }),\n              128\n              /* KEYED_FRAGMENT */\n            ))\n          ])\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"btn-submit text-center\",\n          onClick: onSubmit\n        }, \" \\u786E\\u8BA4\\u5212\\u8F6C \")\n      ]);\n    };\n  }\n});\n",
      "start": 1714699770698,
      "end": 1714699771555,
      "order": "normal",
      "sourcemaps": "{\n  \"version\": 3,\n  \"sources\": [\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Bricks/Transfer.vue?vue&type=script&setup=true&lang.ts\"],\n  \"sourcesContent\": [\"import { defineComponent as _defineComponent } from \\\"vue\\\";\\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \\\"vue\\\";\\nconst _withScopeId = (n) => (_pushScopeId(\\\"data-v-b1484c1a\\\"), n = n(), _popScopeId(), n);\\nconst _hoisted_1 = { class: \\\"transfer-container flex flex-col justify-between\\\" };\\nconst _hoisted_2 = { class: \\\"transfer-toggle-container flex justify-between\\\" };\\nconst _hoisted_3 = { class: \\\"from-to flex flex-col justify-between\\\" };\\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\\n  \\\"div\\\",\\n  null,\\n  \\\"\\u4ECE\\\",\\n  -1\\n  /* HOISTED */\\n));\\nconst _hoisted_5 = [\\\"src\\\"];\\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\\n  \\\"div\\\",\\n  null,\\n  \\\"\\u5230\\\",\\n  -1\\n  /* HOISTED */\\n));\\nconst _hoisted_7 = { class: \\\"row-item flex items-center\\\" };\\nconst _hoisted_8 = [\\\"src\\\"];\\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\\n  \\\"div\\\",\\n  null,\\n  \\\"\\u77FF\\u5DE5\\u5E01\\\",\\n  -1\\n  /* HOISTED */\\n));\\nconst _hoisted_10 = { class: \\\"row-item flex items-center\\\" };\\nconst _hoisted_11 = [\\\"src\\\"];\\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\\n  \\\"div\\\",\\n  null,\\n  \\\"USDT\\u6CF0\\u8FBE\\u5E01\\\",\\n  -1\\n  /* HOISTED */\\n));\\nconst _hoisted_13 = { class: \\\"self-center\\\" };\\nconst _hoisted_14 = [\\\"src\\\"];\\nconst _hoisted_15 = { class: \\\"transfer-info-container\\\" };\\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\\n  \\\"div\\\",\\n  { class: \\\"amount-text\\\" },\\n  \\\"\\u5212\\u8F6C\\u6570\\u91CF\\\",\\n  -1\\n  /* HOISTED */\\n));\\nconst _hoisted_17 = { class: \\\"input-container flex justify-between items-center\\\" };\\nconst _hoisted_18 = { class: \\\"coin-unit\\\" };\\nconst _hoisted_19 = { class: \\\"item-info-container\\\" };\\nconst _hoisted_20 = { class: \\\"label\\\" };\\nconst _hoisted_21 = { class: \\\"value flex items-center\\\" };\\nconst _hoisted_22 = { key: 0 };\\nconst _hoisted_23 = { class: \\\"unit\\\" };\\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \\\"vue\\\";\\nimport { useRoute } from \\\"vue-router\\\";\\nimport transfer01 from \\\"@/assets/images/bricks/transfer01.png\\\";\\nimport transfer02 from \\\"@/assets/images/bricks/transfer02.png\\\";\\nimport KGB01 from \\\"@/assets/images/bricks/KGB01.png\\\";\\nimport USDT01 from \\\"@/assets/images/bricks/USDT01.png\\\";\\nimport { useAuthStore } from \\\"@/store\\\";\\nimport { storeToRefs } from \\\"pinia\\\";\\nimport { showToast } from \\\"vant\\\";\\nimport info from \\\"@/assets/images/common/info.png\\\";\\nimport success from \\\"@/assets/images/common/success.png\\\";\\nimport { getMoneyExchargeApi } from \\\"@/apis/user\\\";\\nexport default /* @__PURE__ */ _defineComponent({\\n  __name: \\\"Transfer\\\",\\n  setup(__props) {\\n    const authStore = useAuthStore();\\n    const { getUserCoin } = authStore;\\n    const { coins } = storeToRefs(authStore);\\n    const route = useRoute();\\n    const routeParamsMap = {\\n      \\\"kgb-to-usdt\\\": {\\n        mtype: 30,\\n        unit: \\\"CNY\\\"\\n      },\\n      \\\"usdt-to-kgb\\\": {\\n        mtype: 2,\\n        unit: \\\"USDT\\\"\\n      }\\n    };\\n    const [from, to] = route.params.coin.split(\\\"-to-\\\");\\n    const transferMap = ref({\\n      from: routeParamsMap[from + \\\"-to-\\\" + to],\\n      to: routeParamsMap[to + \\\"-to-\\\" + from]\\n    });\\n    const transferCoinsInfo = ref([\\n      { label: \\\"\\u53EF\\u7528\\u91D1\\u989D\\\", value: \\\"0.00\\\" },\\n      { label: \\\"\\u624B\\u7EED\\u8D39(0%)\\\", value: \\\"0.00\\\" },\\n      { label: \\\"\\u5F53\\u524D\\u6C47\\u7387\\\", value: \\\"0.00\\\" },\\n      { label: \\\"\\u5212\\u8F6C\\u83B7\\u5F97\\\", value: \\\"0.00\\\" },\\n      { label: \\\"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\\\", value: \\\"0.00\\\" }\\n    ]);\\n    const transferCoinsAmount = ref(\\\"\\\");\\n    const inputAmount = ref();\\n    const coinInfo = computed(\\n      () => coins.value?.find((item) => item.mtype === transferMap.value.from.mtype)\\n    );\\n    const toCoinInfo = computed(\\n      () => coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)\\n    );\\n    const currExchangeRate = computed(() => {\\n      const fromCoinPrice = +(coinInfo.value?.coinset_config?.coin_price || 0);\\n      const toCoinPrice = +(coins.value?.find((item) => item.mtype === transferMap.value.to.mtype)?.coinset_config?.coin_price || 1);\\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\\n    });\\n    const minTransferAmount = computed(() => {\\n      if (!coinInfo.value?.coinset_config)\\n        return \\\"0.00\\\";\\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\\n    });\\n    const maxAvailableTransfer = computed(\\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\\n    );\\n    const updateCursorPos = (onlyUpdateValue = false) => {\\n      setTimeout(() => {\\n        let amountInputEl = document.querySelector(\\\".amount-input input\\\");\\n        if (amountInputEl) {\\n          amountInputEl.value = transferCoinsAmount.value;\\n          if (onlyUpdateValue) {\\n            amountInputEl = null;\\n            return;\\n          }\\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\\n          amountInputEl = null;\\n        }\\n      }, 20);\\n    };\\n    watch(transferCoinsAmount, (val, oldVal) => {\\n      if (val === \\\".\\\" || val.startsWith(\\\"00\\\")) {\\n        transferCoinsAmount.value = \\\"0.\\\";\\n        updateCursorPos();\\n        return;\\n      }\\n      if (oldVal && val.startsWith(\\\"0\\\")) {\\n        transferCoinsAmount.value = \\\"0\\\";\\n      }\\n      const dotIndex = val.indexOf(\\\".\\\");\\n      if (~dotIndex) {\\n        const str = val.slice(dotIndex + 1, val.length);\\n        const replacer = (match, p1, p2) => {\\n          if (p1.startsWith(\\\"0\\\") && +p1 > 0) {\\n            return \\\"0\\\";\\n          }\\n          return p1 + \\\".\\\" + p2;\\n        };\\n        const newAmount = val.replace(/^(\\\\d+)\\\\.(\\\\d\\\\d).*$/, replacer);\\n        transferCoinsAmount.value = newAmount;\\n        updateCursorPos(true);\\n        return;\\n      }\\n      if (+val > +maxAvailableTransfer.value) {\\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\\n        updateCursorPos();\\n      }\\n    });\\n    watchEffect(() => {\\n      const swaptoFeeRate = +(coinInfo.value?.coinset_config?.swapto_fee || 0);\\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\\n        2\\n      );\\n      transferCoinsInfo.value = [\\n        { label: \\\"\\u53EF\\u7528\\u91D1\\u989D\\\", value: availableCoincash },\\n        {\\n          label: `\\u624B\\u7EED\\u8D39(${swaptoFeeRate * 100}%)`,\\n          value: swaptoFee\\n        },\\n        {\\n          label: \\\"\\u5F53\\u524D\\u6C47\\u7387\\\",\\n          value: currExchangeRate.value\\n        },\\n        {\\n          label: \\\"\\u5212\\u8F6C\\u83B7\\u5F97\\\",\\n          value: finalCoincash\\n        },\\n        {\\n          label: \\\"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\\\",\\n          value: minTransferAmount.value\\n        }\\n      ];\\n    });\\n    const onToggleTransfer = () => {\\n      transferMap.value = {\\n        from: transferMap.value.to,\\n        to: transferMap.value.from\\n      };\\n      transferCoinsAmount.value = \\\"\\\";\\n      getUserCoin({});\\n    };\\n    const onMaxAmount = () => {\\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\\n    };\\n    const onSubmit = async () => {\\n      if (!transferCoinsAmount.value) {\\n        showToast({\\n          message: \\\"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\\\",\\n          icon: info,\\n          iconSize: \\\"48px\\\"\\n        });\\n        return;\\n      }\\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\\n        showToast({\\n          message: \\\"\\u8F93\\u5165\\u7684\\u6570\\u91CF\\u5C0F\\u4E8E\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\\\",\\n          icon: info,\\n          iconSize: \\\"48px\\\"\\n        });\\n        return;\\n      }\\n      try {\\n        const res = await getMoneyExchargeApi({\\n          num: transferCoinsAmount.value,\\n          mtype: transferMap.value.from.mtype,\\n          coin_name: coinInfo.value.coin_name,\\n          to_mtype: transferMap.value.to.mtype,\\n          to_coin_name: toCoinInfo.value.coin_name\\n        });\\n        if (res[\\\"code\\\"] === 0) {\\n          showToast({\\n            message: \\\"\\u6210\\u529F\\\",\\n            icon: success,\\n            iconSize: \\\"48px\\\"\\n          });\\n          transferCoinsAmount.value = \\\"\\\";\\n          getUserCoin({});\\n        }\\n        inputAmount.value?.focus();\\n      } catch (error) {\\n        console.error(error);\\n      }\\n    };\\n    const initAmountEvent = () => {\\n      nextTick(() => {\\n        const amountInputEl = document.querySelector(\\\".amount-input input\\\");\\n        if (amountInputEl) {\\n          amountInputEl.onkeydown = (e) => {\\n            if ([\\\"-\\\", \\\"+\\\"].includes(e.key)) {\\n              return e.preventDefault();\\n            }\\n          };\\n        }\\n      });\\n    };\\n    onMounted(() => {\\n      getUserCoin({});\\n      initAmountEvent();\\n    });\\n    return (_ctx, _cache) => {\\n      const _component_van_field = _resolveComponent(\\\"van-field\\\");\\n      return _openBlock(), _createElementBlock(\\\"div\\\", _hoisted_1, [\\n        _createElementVNode(\\\"div\\\", _hoisted_2, [\\n          _createElementVNode(\\\"div\\\", _hoisted_3, [\\n            _hoisted_4,\\n            _createElementVNode(\\\"img\\\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\\n            _hoisted_6\\n          ]),\\n          _createElementVNode(\\n            \\\"div\\\",\\n            {\\n              class: _normalizeClass([\\\"coin-icon-name flex justify-between\\\", transferMap.value.from.mtype === 30 ? \\\"flex-col\\\" : \\\"flex-col-reverse\\\"])\\n            },\\n            [\\n              _createElementVNode(\\\"div\\\", _hoisted_7, [\\n                _createElementVNode(\\\"img\\\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\\n                _hoisted_9\\n              ]),\\n              _createElementVNode(\\\"div\\\", _hoisted_10, [\\n                _createElementVNode(\\\"img\\\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\\n                _hoisted_12\\n              ])\\n            ],\\n            2\\n            /* CLASS */\\n          ),\\n          _createElementVNode(\\\"div\\\", _hoisted_13, [\\n            _createElementVNode(\\\"img\\\", {\\n              src: _unref(transfer02),\\n              class: \\\"icon-transfer\\\",\\n              onClick: onToggleTransfer\\n            }, null, 8, _hoisted_14)\\n          ])\\n        ]),\\n        _createElementVNode(\\\"div\\\", _hoisted_15, [\\n          _hoisted_16,\\n          _createElementVNode(\\\"div\\\", _hoisted_17, [\\n            _createCommentVNode(\\\" \\u5141\\u8BB8\\u8F93\\u5165\\u6570\\u5B57\\uFF0C\\u8C03\\u8D77\\u5E26\\u7B26\\u53F7\\u7684\\u7EAF\\u6570\\u5B57\\u952E\\u76D8 \\\"),\\n            _createVNode(_component_van_field, {\\n              modelValue: transferCoinsAmount.value,\\n              \\\"onUpdate:modelValue\\\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\\n              ref_key: \\\"inputAmount\\\",\\n              ref: inputAmount,\\n              type: \\\"number\\\",\\n              placeholder: \\\"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\\\",\\n              class: \\\"amount-input\\\"\\n            }, null, 8, [\\\"modelValue\\\"]),\\n            _createElementVNode(\\n              \\\"div\\\",\\n              _hoisted_18,\\n              _toDisplayString(transferMap.value.from.unit),\\n              1\\n              /* TEXT */\\n            ),\\n            _createElementVNode(\\\"div\\\", {\\n              class: \\\"max-amount\\\",\\n              onClick: onMaxAmount\\n            }, \\\" \\u5168\\u90E8 \\\")\\n          ]),\\n          _createElementVNode(\\\"div\\\", _hoisted_19, [\\n            (_openBlock(true), _createElementBlock(\\n              _Fragment,\\n              null,\\n              _renderList(transferCoinsInfo.value, (item, index) => {\\n                return _openBlock(), _createElementBlock(\\\"div\\\", {\\n                  key: index,\\n                  class: \\\"row-item flex justify-between items-center\\\"\\n                }, [\\n                  _createElementVNode(\\n                    \\\"div\\\",\\n                    _hoisted_20,\\n                    _toDisplayString(item.label),\\n                    1\\n                    /* TEXT */\\n                  ),\\n                  _createElementVNode(\\\"div\\\", _hoisted_21, [\\n                    index === 2 ? (_openBlock(), _createElementBlock(\\n                      \\\"span\\\",\\n                      _hoisted_22,\\n                      _toDisplayString(`1 ${transferMap.value.from.unit} \\u2248 ${item.value}`),\\n                      1\\n                      /* TEXT */\\n                    )) : (_openBlock(), _createElementBlock(\\n                      \\\"span\\\",\\n                      {\\n                        key: 1,\\n                        class: _normalizeClass([\\\"amount\\\", { \\\"amount-bold\\\": index === 0 }])\\n                      },\\n                      _toDisplayString(item.value),\\n                      3\\n                      /* TEXT, CLASS */\\n                    )),\\n                    _createElementVNode(\\n                      \\\"span\\\",\\n                      _hoisted_23,\\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\\n                      1\\n                      /* TEXT */\\n                    )\\n                  ])\\n                ]);\\n              }),\\n              128\\n              /* KEYED_FRAGMENT */\\n            ))\\n          ])\\n        ]),\\n        _createElementVNode(\\\"div\\\", {\\n          class: \\\"btn-submit text-center\\\",\\n          onClick: onSubmit\\n        }, \\\" \\u786E\\u8BA4\\u5212\\u8F6C \\\")\\n      ]);\\n    };\\n  }\\n});\\n\"],\n  \"mappings\": \";AAAA,SAAS,mBAAmB,wBAAwB;AACpD,SAAS,sBAAsB,qBAAqB,SAAS,QAAQ,kBAAkB,iBAAiB,sBAAsB,qBAAqB,oBAAoB,mBAAmB,eAAe,cAAc,mBAAmB,kBAAkB,cAAc,aAAa,YAAY,WAAW,aAAa,YAAY,sBAAsB,qBAAqB,eAAe,cAAc,cAAc,mBAAmB;AAChb,MAAM,eAAe,CAAC,OAAO,aAAa,iBAAiB,GAAG,IAAI,EAAE,GAAG,YAAY,GAAG;AACtF,MAAM,aAAa,EAAE,OAAO,mDAAmD;AAC/E,MAAM,aAAa,EAAE,OAAO,iDAAiD;AAC7E,MAAM,aAAa,EAAE,OAAO,wCAAwC;AACpE,MAAM,aAA6B,6BAAa,MAAsB;AAAA,EACpE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAEF,CAAC;AACD,MAAM,aAAa,CAAC,KAAK;AACzB,MAAM,aAA6B,6BAAa,MAAsB;AAAA,EACpE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAEF,CAAC;AACD,MAAM,aAAa,EAAE,OAAO,6BAA6B;AACzD,MAAM,aAAa,CAAC,KAAK;AACzB,MAAM,aAA6B,6BAAa,MAAsB;AAAA,EACpE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAEF,CAAC;AACD,MAAM,cAAc,EAAE,OAAO,6BAA6B;AAC1D,MAAM,cAAc,CAAC,KAAK;AAC1B,MAAM,cAA8B,6BAAa,MAAsB;AAAA,EACrE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAEF,CAAC;AACD,MAAM,cAAc,EAAE,OAAO,cAAc;AAC3C,MAAM,cAAc,CAAC,KAAK;AAC1B,MAAM,cAAc,EAAE,OAAO,0BAA0B;AACvD,MAAM,cAA8B,6BAAa,MAAsB;AAAA,EACrE;AAAA,EACA,EAAE,OAAO,cAAc;AAAA,EACvB;AAAA,EACA;AAAA;AAEF,CAAC;AACD,MAAM,cAAc,EAAE,OAAO,oDAAoD;AACjF,MAAM,cAAc,EAAE,OAAO,YAAY;AACzC,MAAM,cAAc,EAAE,OAAO,sBAAsB;AACnD,MAAM,cAAc,EAAE,OAAO,QAAQ;AACrC,MAAM,cAAc,EAAE,OAAO,0BAA0B;AACvD,MAAM,cAAc,EAAE,KAAK,EAAE;AAC7B,MAAM,cAAc,EAAE,OAAO,OAAO;AACpC,SAAS,UAAU,UAAU,WAAW,KAAK,OAAO,mBAAmB;AACvE,SAAS,gBAAgB;AACzB,OAAO,gBAAgB;AACvB,OAAO,gBAAgB;AACvB,OAAO,WAAW;AAClB,OAAO,YAAY;AACnB,SAAS,oBAAoB;AAC7B,SAAS,mBAAmB;AAC5B,SAAS,iBAAiB;AAC1B,OAAO,UAAU;AACjB,OAAO,aAAa;AACpB,SAAS,2BAA2B;AACpC,eAA+B,iCAAiB;AAAA,EAC9C,QAAQ;AAAA,EACR,MAAM,SAAS;AACb,UAAM,YAAY,aAAa;AAC/B,UAAM,EAAE,YAAY,IAAI;AACxB,UAAM,EAAE,MAAM,IAAI,YAAY,SAAS;AACvC,UAAM,QAAQ,SAAS;AACvB,UAAM,iBAAiB;AAAA,MACrB,eAAe;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACR;AAAA,MACA,eAAe;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACR;AAAA,IACF;AACA,UAAM,CAAC,MAAM,EAAE,IAAI,MAAM,OAAO,KAAK,MAAM,MAAM;AACjD,UAAM,cAAc,IAAI;AAAA,MACtB,MAAM,eAAe,OAAO,SAAS,EAAE;AAAA,MACvC,IAAI,eAAe,KAAK,SAAS,IAAI;AAAA,IACvC,CAAC;AACD,UAAM,oBAAoB,IAAI;AAAA,MAC5B,EAAE,OAAO,4BAAQ,OAAO,OAAO;AAAA,MAC/B,EAAE,OAAO,0BAAW,OAAO,OAAO;AAAA,MAClC,EAAE,OAAO,4BAAQ,OAAO,OAAO;AAAA,MAC/B,EAAE,OAAO,4BAAQ,OAAO,OAAO;AAAA,MAC/B,EAAE,OAAO,wCAAU,OAAO,OAAO;AAAA,IACnC,CAAC;AACD,UAAM,sBAAsB,IAAI,EAAE;AAClC,UAAM,cAAc,IAAI;AACxB,UAAM,WAAW;AAAA,MACf,MAAG;AApGT;AAoGY,2BAAM,UAAN,mBAAa,KAAK,CAAC,SAAS,KAAK,UAAU,YAAY,MAAM,KAAK;AAAA;AAAA,IAC1E;AACA,UAAM,aAAa;AAAA,MACjB,MAAG;AAvGT;AAuGY,2BAAM,UAAN,mBAAa,KAAK,CAAC,SAAS,KAAK,UAAU,YAAY,MAAM,GAAG;AAAA;AAAA,IACxE;AACA,UAAM,mBAAmB,SAAS,MAAM;AAzG5C;AA0GM,YAAM,gBAAgB,IAAE,oBAAS,UAAT,mBAAgB,mBAAhB,mBAAgC,eAAc;AACtE,YAAM,cAAc,IAAE,uBAAM,UAAN,mBAAa,KAAK,CAAC,SAAS,KAAK,UAAU,YAAY,MAAM,GAAG,WAAhE,mBAAwE,mBAAxE,mBAAwF,eAAc;AAC5H,cAAQ,gBAAgB,aAAa,aAAa,CAAC;AAAA,IACrD,CAAC;AACD,UAAM,oBAAoB,SAAS,MAAM;AA9G7C;AA+GM,UAAI,GAAC,cAAS,UAAT,mBAAgB;AACnB,eAAO;AACT,cAAQ,CAAC,SAAS,MAAM,eAAe,aAAa,CAAC,SAAS,MAAM,eAAe,YAAY,aAAa,CAAC;AAAA,IAC/G,CAAC;AACD,UAAM,uBAAuB;AAAA,MAC3B,MAAM,CAAC,SAAS,MAAM,sBAAsB,IAAI,CAAC,SAAS,MAAM,eAAe;AAAA,IACjF;AACA,UAAM,kBAAkB,CAAC,kBAAkB,UAAU;AACnD,iBAAW,MAAM;AACf,YAAI,gBAAgB,SAAS,cAAc,qBAAqB;AAChE,YAAI,eAAe;AACjB,wBAAc,QAAQ,oBAAoB;AAC1C,cAAI,iBAAiB;AACnB,4BAAgB;AAChB;AAAA,UACF;AACA,wBAAc,iBAAiB,oBAAoB,MAAM;AACzD,wBAAc,eAAe,oBAAoB,MAAM;AACvD,0BAAgB;AAAA,QAClB;AAAA,MACF,GAAG,EAAE;AAAA,IACP;AACA,UAAM,qBAAqB,CAAC,KAAK,WAAW;AAC1C,UAAI,QAAQ,OAAO,IAAI,WAAW,IAAI,GAAG;AACvC,4BAAoB,QAAQ;AAC5B,wBAAgB;AAChB;AAAA,MACF;AACA,UAAI,UAAU,IAAI,WAAW,GAAG,GAAG;AACjC,4BAAoB,QAAQ;AAAA,MAC9B;AACA,YAAM,WAAW,IAAI,QAAQ,GAAG;AAChC,UAAI,CAAC,UAAU;AACb,cAAM,MAAM,IAAI,MAAM,WAAW,GAAG,IAAI,MAAM;AAC9C,cAAM,WAAW,CAAC,OAAO,IAAI,OAAO;AAClC,cAAI,GAAG,WAAW,GAAG,KAAK,CAAC,KAAK,GAAG;AACjC,mBAAO;AAAA,UACT;AACA,iBAAO,KAAK,MAAM;AAAA,QACpB;AACA,cAAM,YAAY,IAAI,QAAQ,qBAAqB,QAAQ;AAC3D,4BAAoB,QAAQ;AAC5B,wBAAgB,IAAI;AACpB;AAAA,MACF;AACA,UAAI,CAAC,MAAM,CAAC,qBAAqB,OAAO;AACtC,4BAAoB,QAAQ,qBAAqB,MAAM,aAAa,CAAC;AACrE,wBAAgB;AAAA,MAClB;AAAA,IACF,CAAC;AACD,gBAAY,MAAM;AAjKtB;AAkKM,YAAM,gBAAgB,IAAE,oBAAS,UAAT,mBAAgB,mBAAhB,mBAAgC,eAAc;AACtE,YAAM,aAAa,EAAE,oBAAoB,SAAS,KAAK,eAAe,aAAa,CAAC;AACpF,YAAM,qBAAqB,CAAC,SAAS,MAAM,oBAAoB,aAAa,CAAC;AAC7E,YAAM,iBAAiB,CAAC,iBAAiB,QAAQ,EAAE,oBAAoB,SAAS,IAAI;AAAA,QAClF;AAAA,MACF;AACA,wBAAkB,QAAQ;AAAA,QACxB,EAAE,OAAO,4BAAQ,OAAO,kBAAkB;AAAA,QAC1C;AAAA,UACE,OAAO,sBAAO,gBAAgB,GAAG;AAAA,UACjC,OAAO;AAAA,QACT;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,OAAO,iBAAiB;AAAA,QAC1B;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,OAAO;AAAA,QACT;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,OAAO,kBAAkB;AAAA,QAC3B;AAAA,MACF;AAAA,IACF,CAAC;AACD,UAAM,mBAAmB,MAAM;AAC7B,kBAAY,QAAQ;AAAA,QAClB,MAAM,YAAY,MAAM;AAAA,QACxB,IAAI,YAAY,MAAM;AAAA,MACxB;AACA,0BAAoB,QAAQ;AAC5B,kBAAY,CAAC,CAAC;AAAA,IAChB;AACA,UAAM,cAAc,MAAM;AACxB,0BAAoB,QAAQ,qBAAqB,MAAM,aAAa,CAAC;AAAA,IACvE;AACA,UAAM,WAAW,YAAY;AAvMjC;AAwMM,UAAI,CAAC,oBAAoB,OAAO;AAC9B,kBAAU;AAAA,UACR,SAAS;AAAA,UACT,MAAM;AAAA,UACN,UAAU;AAAA,QACZ,CAAC;AACD;AAAA,MACF;AACA,UAAI,CAAC,oBAAoB,QAAQ,CAAC,kBAAkB,OAAO;AACzD,kBAAU;AAAA,UACR,SAAS;AAAA,UACT,MAAM;AAAA,UACN,UAAU;AAAA,QACZ,CAAC;AACD;AAAA,MACF;AACA,UAAI;AACF,cAAM,MAAM,MAAM,oBAAoB;AAAA,UACpC,KAAK,oBAAoB;AAAA,UACzB,OAAO,YAAY,MAAM,KAAK;AAAA,UAC9B,WAAW,SAAS,MAAM;AAAA,UAC1B,UAAU,YAAY,MAAM,GAAG;AAAA,UAC/B,cAAc,WAAW,MAAM;AAAA,QACjC,CAAC;AACD,YAAI,IAAI,MAAM,MAAM,GAAG;AACrB,oBAAU;AAAA,YACR,SAAS;AAAA,YACT,MAAM;AAAA,YACN,UAAU;AAAA,UACZ,CAAC;AACD,8BAAoB,QAAQ;AAC5B,sBAAY,CAAC,CAAC;AAAA,QAChB;AACA,0BAAY,UAAZ,mBAAmB;AAAA,MACrB,SAAS,OAAO;AACd,gBAAQ,MAAM,KAAK;AAAA,MACrB;AAAA,IACF;AACA,UAAM,kBAAkB,MAAM;AAC5B,eAAS,MAAM;AACb,cAAM,gBAAgB,SAAS,cAAc,qBAAqB;AAClE,YAAI,eAAe;AACjB,wBAAc,YAAY,CAAC,MAAM;AAC/B,gBAAI,CAAC,KAAK,GAAG,EAAE,SAAS,EAAE,GAAG,GAAG;AAC9B,qBAAO,EAAE,eAAe;AAAA,YAC1B;AAAA,UACF;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AACA,cAAU,MAAM;AACd,kBAAY,CAAC,CAAC;AACd,sBAAgB;AAAA,IAClB,CAAC;AACD,WAAO,CAAC,MAAM,WAAW;AACvB,YAAM,uBAAuB,kBAAkB,WAAW;AAC1D,aAAO,WAAW,GAAG,oBAAoB,OAAO,YAAY;AAAA,QAC1D,oBAAoB,OAAO,YAAY;AAAA,UACrC,oBAAoB,OAAO,YAAY;AAAA,YACrC;AAAA,YACA,oBAAoB,OAAO,EAAE,KAAK,OAAO,UAAU,EAAE,GAAG,MAAM,GAAG,UAAU;AAAA,YAC3E;AAAA,UACF,CAAC;AAAA,UACD;AAAA,YACE;AAAA,YACA;AAAA,cACE,OAAO,gBAAgB,CAAC,uCAAuC,YAAY,MAAM,KAAK,UAAU,KAAK,aAAa,kBAAkB,CAAC;AAAA,YACvI;AAAA,YACA;AAAA,cACE,oBAAoB,OAAO,YAAY;AAAA,gBACrC,oBAAoB,OAAO,EAAE,KAAK,OAAO,KAAK,EAAE,GAAG,MAAM,GAAG,UAAU;AAAA,gBACtE;AAAA,cACF,CAAC;AAAA,cACD,oBAAoB,OAAO,aAAa;AAAA,gBACtC,oBAAoB,OAAO,EAAE,KAAK,OAAO,MAAM,EAAE,GAAG,MAAM,GAAG,WAAW;AAAA,gBACxE;AAAA,cACF,CAAC;AAAA,YACH;AAAA,YACA;AAAA;AAAA,UAEF;AAAA,UACA,oBAAoB,OAAO,aAAa;AAAA,YACtC,oBAAoB,OAAO;AAAA,cACzB,KAAK,OAAO,UAAU;AAAA,cACtB,OAAO;AAAA,cACP,SAAS;AAAA,YACX,GAAG,MAAM,GAAG,WAAW;AAAA,UACzB,CAAC;AAAA,QACH,CAAC;AAAA,QACD,oBAAoB,OAAO,aAAa;AAAA,UACtC;AAAA,UACA,oBAAoB,OAAO,aAAa;AAAA,YACtC,oBAAoB,gHAAsB;AAAA,YAC1C,aAAa,sBAAsB;AAAA,cACjC,YAAY,oBAAoB;AAAA,cAChC,uBAAuB,OAAO,CAAC,MAAM,OAAO,CAAC,IAAI,CAAC,WAAW,oBAAoB,QAAQ;AAAA,cACzF,SAAS;AAAA,cACT,KAAK;AAAA,cACL,MAAM;AAAA,cACN,aAAa;AAAA,cACb,OAAO;AAAA,YACT,GAAG,MAAM,GAAG,CAAC,YAAY,CAAC;AAAA,YAC1B;AAAA,cACE;AAAA,cACA;AAAA,cACA,iBAAiB,YAAY,MAAM,KAAK,IAAI;AAAA,cAC5C;AAAA;AAAA,YAEF;AAAA,YACA,oBAAoB,OAAO;AAAA,cACzB,OAAO;AAAA,cACP,SAAS;AAAA,YACX,GAAG,gBAAM;AAAA,UACX,CAAC;AAAA,UACD,oBAAoB,OAAO,aAAa;AAAA,aACrC,WAAW,IAAI,GAAG;AAAA,cACjB;AAAA,cACA;AAAA,cACA,YAAY,kBAAkB,OAAO,CAAC,MAAM,UAAU;AACpD,uBAAO,WAAW,GAAG,oBAAoB,OAAO;AAAA,kBAC9C,KAAK;AAAA,kBACL,OAAO;AAAA,gBACT,GAAG;AAAA,kBACD;AAAA,oBACE;AAAA,oBACA;AAAA,oBACA,iBAAiB,KAAK,KAAK;AAAA,oBAC3B;AAAA;AAAA,kBAEF;AAAA,kBACA,oBAAoB,OAAO,aAAa;AAAA,oBACtC,UAAU,KAAK,WAAW,GAAG;AAAA,sBAC3B;AAAA,sBACA;AAAA,sBACA,iBAAiB,KAAK,YAAY,MAAM,KAAK,IAAI,WAAM,KAAK,KAAK,EAAE;AAAA,sBACnE;AAAA;AAAA,oBAEF,MAAM,WAAW,GAAG;AAAA,sBAClB;AAAA,sBACA;AAAA,wBACE,KAAK;AAAA,wBACL,OAAO,gBAAgB,CAAC,UAAU,EAAE,eAAe,UAAU,EAAE,CAAC,CAAC;AAAA,sBACnE;AAAA,sBACA,iBAAiB,KAAK,KAAK;AAAA,sBAC3B;AAAA;AAAA,oBAEF;AAAA,oBACA;AAAA,sBACE;AAAA,sBACA;AAAA,sBACA,iBAAiB,CAAC,GAAG,GAAG,CAAC,EAAE,SAAS,KAAK,IAAI,YAAY,MAAM,KAAK,OAAO,YAAY,MAAM,GAAG,IAAI;AAAA,sBACpG;AAAA;AAAA,oBAEF;AAAA,kBACF,CAAC;AAAA,gBACH,CAAC;AAAA,cACH,CAAC;AAAA,cACD;AAAA;AAAA,YAEF;AAAA,UACF,CAAC;AAAA,QACH,CAAC;AAAA,QACD,oBAAoB,OAAO;AAAA,UACzB,OAAO;AAAA,UACP,SAAS;AAAA,QACX,GAAG,4BAAQ;AAAA,MACb,CAAC;AAAA,IACH;AAAA,EACF;AACF,CAAC;\",\n  \"names\": []\n}\n"
    },
    {
      "name": "vite:define",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:css-post",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:build-html",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:worker-import-meta-url",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:asset-import-meta-url",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "commonjs",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:dynamic-import-vars",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "vite:import-glob",
      "start": 1714699771555,
      "end": 1714699771555,
      "order": "normal"
    },
    {
      "name": "unplugin-auto-import",
      "start": 1714699771555,
      "end": 1714699771557,
      "order": "post"
    },
    {
      "name": "unplugin-vue-components",
      "result": "/* unplugin-vue-components disabled */import { Field as __unplugin_components_0 } from 'vant/es';import 'vant/es/field/style/index';\n\"use strict\";\nimport { defineComponent as _defineComponent } from \"vue\";\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = (n) => (_pushScopeId(\"data-v-b1484c1a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" };\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" };\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" };\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u4ECE\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u5230\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_7 = { class: \"row-item flex items-center\" };\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u77FF\\u5DE5\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_10 = { class: \"row-item flex items-center\" };\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"USDT\\u6CF0\\u8FBE\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_13 = { class: \"self-center\" };\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = { class: \"transfer-info-container\" };\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  { class: \"amount-text\" },\n  \"\\u5212\\u8F6C\\u6570\\u91CF\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" };\nconst _hoisted_18 = { class: \"coin-unit\" };\nconst _hoisted_19 = { class: \"item-info-container\" };\nconst _hoisted_20 = { class: \"label\" };\nconst _hoisted_21 = { class: \"value flex items-center\" };\nconst _hoisted_22 = { key: 0 };\nconst _hoisted_23 = { class: \"unit\" };\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport transfer01 from \"@/assets/images/bricks/transfer01.png\";\nimport transfer02 from \"@/assets/images/bricks/transfer02.png\";\nimport KGB01 from \"@/assets/images/bricks/KGB01.png\";\nimport USDT01 from \"@/assets/images/bricks/USDT01.png\";\nimport { useAuthStore } from \"@/store\";\nimport { storeToRefs } from \"pinia\";\nimport { showToast } from \"vant\";\nimport info from \"@/assets/images/common/info.png\";\nimport success from \"@/assets/images/common/success.png\";\nimport { getMoneyExchargeApi } from \"@/apis/user\";\nexport default /* @__PURE__ */ _defineComponent({\n  __name: \"Transfer\",\n  setup(__props) {\n    const authStore = useAuthStore();\n    const { getUserCoin } = authStore;\n    const { coins } = storeToRefs(authStore);\n    const route = useRoute();\n    const routeParamsMap = {\n      \"kgb-to-usdt\": {\n        mtype: 30,\n        unit: \"CNY\"\n      },\n      \"usdt-to-kgb\": {\n        mtype: 2,\n        unit: \"USDT\"\n      }\n    };\n    const [from, to] = route.params.coin.split(\"-to-\");\n    const transferMap = ref({\n      from: routeParamsMap[from + \"-to-\" + to],\n      to: routeParamsMap[to + \"-to-\" + from]\n    });\n    const transferCoinsInfo = ref([\n      { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: \"0.00\" },\n      { label: \"\\u624B\\u7EED\\u8D39(0%)\", value: \"0.00\" },\n      { label: \"\\u5F53\\u524D\\u6C47\\u7387\", value: \"0.00\" },\n      { label: \"\\u5212\\u8F6C\\u83B7\\u5F97\", value: \"0.00\" },\n      { label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\", value: \"0.00\" }\n    ]);\n    const transferCoinsAmount = ref(\"\");\n    const inputAmount = ref();\n    const coinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.from.mtype);\n      }\n    );\n    const toCoinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.to.mtype);\n      }\n    );\n    const currExchangeRate = computed(() => {\n      var _a, _b, _c, _d, _e;\n      const fromCoinPrice = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.coin_price) || 0);\n      const toCoinPrice = +(((_e = (_d = (_c = coins.value) == null ? void 0 : _c.find((item) => item.mtype === transferMap.value.to.mtype)) == null ? void 0 : _d.coinset_config) == null ? void 0 : _e.coin_price) || 1);\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\n    });\n    const minTransferAmount = computed(() => {\n      var _a;\n      if (!((_a = coinInfo.value) == null ? void 0 : _a.coinset_config))\n        return \"0.00\";\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\n    });\n    const maxAvailableTransfer = computed(\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\n    );\n    const updateCursorPos = (onlyUpdateValue = false) => {\n      setTimeout(() => {\n        let amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.value = transferCoinsAmount.value;\n          if (onlyUpdateValue) {\n            amountInputEl = null;\n            return;\n          }\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\n          amountInputEl = null;\n        }\n      }, 20);\n    };\n    watch(transferCoinsAmount, (val, oldVal) => {\n      if (val === \".\" || val.startsWith(\"00\")) {\n        transferCoinsAmount.value = \"0.\";\n        updateCursorPos();\n        return;\n      }\n      if (oldVal && val.startsWith(\"0\")) {\n        transferCoinsAmount.value = \"0\";\n      }\n      const dotIndex = val.indexOf(\".\");\n      if (~dotIndex) {\n        const str = val.slice(dotIndex + 1, val.length);\n        const replacer = (match, p1, p2) => {\n          if (p1.startsWith(\"0\") && +p1 > 0) {\n            return \"0\";\n          }\n          return p1 + \".\" + p2;\n        };\n        const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer);\n        transferCoinsAmount.value = newAmount;\n        updateCursorPos(true);\n        return;\n      }\n      if (+val > +maxAvailableTransfer.value) {\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n        updateCursorPos();\n      }\n    });\n    watchEffect(() => {\n      var _a, _b;\n      const swaptoFeeRate = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.swapto_fee) || 0);\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n        2\n      );\n      transferCoinsInfo.value = [\n        { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: availableCoincash },\n        {\n          label: `\\u624B\\u7EED\\u8D39(${swaptoFeeRate * 100}%)`,\n          value: swaptoFee\n        },\n        {\n          label: \"\\u5F53\\u524D\\u6C47\\u7387\",\n          value: currExchangeRate.value\n        },\n        {\n          label: \"\\u5212\\u8F6C\\u83B7\\u5F97\",\n          value: finalCoincash\n        },\n        {\n          label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          value: minTransferAmount.value\n        }\n      ];\n    });\n    const onToggleTransfer = () => {\n      transferMap.value = {\n        from: transferMap.value.to,\n        to: transferMap.value.from\n      };\n      transferCoinsAmount.value = \"\";\n      getUserCoin({});\n    };\n    const onMaxAmount = () => {\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n    };\n    const onSubmit = async () => {\n      var _a;\n      if (!transferCoinsAmount.value) {\n        showToast({\n          message: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\n        showToast({\n          message: \"\\u8F93\\u5165\\u7684\\u6570\\u91CF\\u5C0F\\u4E8E\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      try {\n        const res = await getMoneyExchargeApi({\n          num: transferCoinsAmount.value,\n          mtype: transferMap.value.from.mtype,\n          coin_name: coinInfo.value.coin_name,\n          to_mtype: transferMap.value.to.mtype,\n          to_coin_name: toCoinInfo.value.coin_name\n        });\n        if (res[\"code\"] === 0) {\n          showToast({\n            message: \"\\u6210\\u529F\",\n            icon: success,\n            iconSize: \"48px\"\n          });\n          transferCoinsAmount.value = \"\";\n          getUserCoin({});\n        }\n        (_a = inputAmount.value) == null ? void 0 : _a.focus();\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    const initAmountEvent = () => {\n      nextTick(() => {\n        const amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.onkeydown = (e) => {\n            if ([\"-\", \"+\"].includes(e.key)) {\n              return e.preventDefault();\n            }\n          };\n        }\n      });\n    };\n    onMounted(() => {\n      getUserCoin({});\n      initAmountEvent();\n    });\n    return (_ctx, _cache) => {\n      const _component_van_field = __unplugin_components_0;\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\n            _hoisted_6\n          ]),\n          _createElementVNode(\n            \"div\",\n            {\n              class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? \"flex-col\" : \"flex-col-reverse\"])\n            },\n            [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\n                _hoisted_9\n              ]),\n              _createElementVNode(\"div\", _hoisted_10, [\n                _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\n                _hoisted_12\n              ])\n            ],\n            2\n            /* CLASS */\n          ),\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"img\", {\n              src: _unref(transfer02),\n              class: \"icon-transfer\",\n              onClick: onToggleTransfer\n            }, null, 8, _hoisted_14)\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _hoisted_16,\n          _createElementVNode(\"div\", _hoisted_17, [\n            _createCommentVNode(\" \\u5141\\u8BB8\\u8F93\\u5165\\u6570\\u5B57\\uFF0C\\u8C03\\u8D77\\u5E26\\u7B26\\u53F7\\u7684\\u7EAF\\u6570\\u5B57\\u952E\\u76D8 \"),\n            _createVNode(_component_van_field, {\n              modelValue: transferCoinsAmount.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\n              ref_key: \"inputAmount\",\n              ref: inputAmount,\n              type: \"number\",\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n              class: \"amount-input\"\n            }, null, 8, [\"modelValue\"]),\n            _createElementVNode(\n              \"div\",\n              _hoisted_18,\n              _toDisplayString(transferMap.value.from.unit),\n              1\n              /* TEXT */\n            ),\n            _createElementVNode(\"div\", {\n              class: \"max-amount\",\n              onClick: onMaxAmount\n            }, \" \\u5168\\u90E8 \")\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            (_openBlock(true), _createElementBlock(\n              _Fragment,\n              null,\n              _renderList(transferCoinsInfo.value, (item, index) => {\n                return _openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"row-item flex justify-between items-center\"\n                }, [\n                  _createElementVNode(\n                    \"div\",\n                    _hoisted_20,\n                    _toDisplayString(item.label),\n                    1\n                    /* TEXT */\n                  ),\n                  _createElementVNode(\"div\", _hoisted_21, [\n                    index === 2 ? (_openBlock(), _createElementBlock(\n                      \"span\",\n                      _hoisted_22,\n                      _toDisplayString(`1 ${transferMap.value.from.unit} \\u2248 ${item.value}`),\n                      1\n                      /* TEXT */\n                    )) : (_openBlock(), _createElementBlock(\n                      \"span\",\n                      {\n                        key: 1,\n                        class: _normalizeClass([\"amount\", { \"amount-bold\": index === 0 }])\n                      },\n                      _toDisplayString(item.value),\n                      3\n                      /* TEXT, CLASS */\n                    )),\n                    _createElementVNode(\n                      \"span\",\n                      _hoisted_23,\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\n                      1\n                      /* TEXT */\n                    )\n                  ])\n                ]);\n              }),\n              128\n              /* KEYED_FRAGMENT */\n            ))\n          ])\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"btn-submit text-center\",\n          onClick: onSubmit\n        }, \" \\u786E\\u8BA4\\u5212\\u8F6C \")\n      ]);\n    };\n  }\n});\n",
      "start": 1714699771557,
      "end": 1714699771558,
      "order": "post",
      "sourcemaps": {
        "version": 3,
        "sources": [
          "/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Bricks/Transfer.vue?vue&type=script&setup=true&lang.ts"
        ],
        "sourcesContent": [
          "\"use strict\";\nimport { defineComponent as _defineComponent } from \"vue\";\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = (n) => (_pushScopeId(\"data-v-b1484c1a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = { class: \"transfer-container flex flex-col justify-between\" };\nconst _hoisted_2 = { class: \"transfer-toggle-container flex justify-between\" };\nconst _hoisted_3 = { class: \"from-to flex flex-col justify-between\" };\nconst _hoisted_4 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u4ECE\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u5230\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_7 = { class: \"row-item flex items-center\" };\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"\\u77FF\\u5DE5\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_10 = { class: \"row-item flex items-center\" };\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  null,\n  \"USDT\\u6CF0\\u8FBE\\u5E01\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_13 = { class: \"self-center\" };\nconst _hoisted_14 = [\"src\"];\nconst _hoisted_15 = { class: \"transfer-info-container\" };\nconst _hoisted_16 = /* @__PURE__ */ _withScopeId(() => /* @__PURE__ */ _createElementVNode(\n  \"div\",\n  { class: \"amount-text\" },\n  \"\\u5212\\u8F6C\\u6570\\u91CF\",\n  -1\n  /* HOISTED */\n));\nconst _hoisted_17 = { class: \"input-container flex justify-between items-center\" };\nconst _hoisted_18 = { class: \"coin-unit\" };\nconst _hoisted_19 = { class: \"item-info-container\" };\nconst _hoisted_20 = { class: \"label\" };\nconst _hoisted_21 = { class: \"value flex items-center\" };\nconst _hoisted_22 = { key: 0 };\nconst _hoisted_23 = { class: \"unit\" };\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport transfer01 from \"@/assets/images/bricks/transfer01.png\";\nimport transfer02 from \"@/assets/images/bricks/transfer02.png\";\nimport KGB01 from \"@/assets/images/bricks/KGB01.png\";\nimport USDT01 from \"@/assets/images/bricks/USDT01.png\";\nimport { useAuthStore } from \"@/store\";\nimport { storeToRefs } from \"pinia\";\nimport { showToast } from \"vant\";\nimport info from \"@/assets/images/common/info.png\";\nimport success from \"@/assets/images/common/success.png\";\nimport { getMoneyExchargeApi } from \"@/apis/user\";\nexport default /* @__PURE__ */ _defineComponent({\n  __name: \"Transfer\",\n  setup(__props) {\n    const authStore = useAuthStore();\n    const { getUserCoin } = authStore;\n    const { coins } = storeToRefs(authStore);\n    const route = useRoute();\n    const routeParamsMap = {\n      \"kgb-to-usdt\": {\n        mtype: 30,\n        unit: \"CNY\"\n      },\n      \"usdt-to-kgb\": {\n        mtype: 2,\n        unit: \"USDT\"\n      }\n    };\n    const [from, to] = route.params.coin.split(\"-to-\");\n    const transferMap = ref({\n      from: routeParamsMap[from + \"-to-\" + to],\n      to: routeParamsMap[to + \"-to-\" + from]\n    });\n    const transferCoinsInfo = ref([\n      { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: \"0.00\" },\n      { label: \"\\u624B\\u7EED\\u8D39(0%)\", value: \"0.00\" },\n      { label: \"\\u5F53\\u524D\\u6C47\\u7387\", value: \"0.00\" },\n      { label: \"\\u5212\\u8F6C\\u83B7\\u5F97\", value: \"0.00\" },\n      { label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\", value: \"0.00\" }\n    ]);\n    const transferCoinsAmount = ref(\"\");\n    const inputAmount = ref();\n    const coinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.from.mtype);\n      }\n    );\n    const toCoinInfo = computed(\n      () => {\n        var _a;\n        return (_a = coins.value) == null ? void 0 : _a.find((item) => item.mtype === transferMap.value.to.mtype);\n      }\n    );\n    const currExchangeRate = computed(() => {\n      var _a, _b, _c, _d, _e;\n      const fromCoinPrice = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.coin_price) || 0);\n      const toCoinPrice = +(((_e = (_d = (_c = coins.value) == null ? void 0 : _c.find((item) => item.mtype === transferMap.value.to.mtype)) == null ? void 0 : _d.coinset_config) == null ? void 0 : _e.coin_price) || 1);\n      return (fromCoinPrice / toCoinPrice).toTruncFixed(3);\n    });\n    const minTransferAmount = computed(() => {\n      var _a;\n      if (!((_a = coinInfo.value) == null ? void 0 : _a.coinset_config))\n        return \"0.00\";\n      return (+coinInfo.value.coinset_config.min_swapto / +coinInfo.value.coinset_config.coin_price).toTruncFixed(2);\n    });\n    const maxAvailableTransfer = computed(\n      () => +coinInfo.value.available_coincash / (1 + +coinInfo.value.coinset_config.swapto_fee)\n    );\n    const updateCursorPos = (onlyUpdateValue = false) => {\n      setTimeout(() => {\n        let amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.value = transferCoinsAmount.value;\n          if (onlyUpdateValue) {\n            amountInputEl = null;\n            return;\n          }\n          amountInputEl.selectionStart = transferCoinsAmount.value.length;\n          amountInputEl.selectionEnd = transferCoinsAmount.value.length;\n          amountInputEl = null;\n        }\n      }, 20);\n    };\n    watch(transferCoinsAmount, (val, oldVal) => {\n      if (val === \".\" || val.startsWith(\"00\")) {\n        transferCoinsAmount.value = \"0.\";\n        updateCursorPos();\n        return;\n      }\n      if (oldVal && val.startsWith(\"0\")) {\n        transferCoinsAmount.value = \"0\";\n      }\n      const dotIndex = val.indexOf(\".\");\n      if (~dotIndex) {\n        const str = val.slice(dotIndex + 1, val.length);\n        const replacer = (match, p1, p2) => {\n          if (p1.startsWith(\"0\") && +p1 > 0) {\n            return \"0\";\n          }\n          return p1 + \".\" + p2;\n        };\n        const newAmount = val.replace(/^(\\d+)\\.(\\d\\d).*$/, replacer);\n        transferCoinsAmount.value = newAmount;\n        updateCursorPos(true);\n        return;\n      }\n      if (+val > +maxAvailableTransfer.value) {\n        transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n        updateCursorPos();\n      }\n    });\n    watchEffect(() => {\n      var _a, _b;\n      const swaptoFeeRate = +(((_b = (_a = coinInfo.value) == null ? void 0 : _a.coinset_config) == null ? void 0 : _b.swapto_fee) || 0);\n      const swaptoFee = (+(transferCoinsAmount.value || 0) * swaptoFeeRate).toTruncFixed(2);\n      const availableCoincash = (+coinInfo.value.available_coincash).toTruncFixed(2);\n      const finalCoincash = (+currExchangeRate.value * +(transferCoinsAmount.value || 0)).toTruncFixed(\n        2\n      );\n      transferCoinsInfo.value = [\n        { label: \"\\u53EF\\u7528\\u91D1\\u989D\", value: availableCoincash },\n        {\n          label: `\\u624B\\u7EED\\u8D39(${swaptoFeeRate * 100}%)`,\n          value: swaptoFee\n        },\n        {\n          label: \"\\u5F53\\u524D\\u6C47\\u7387\",\n          value: currExchangeRate.value\n        },\n        {\n          label: \"\\u5212\\u8F6C\\u83B7\\u5F97\",\n          value: finalCoincash\n        },\n        {\n          label: \"\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          value: minTransferAmount.value\n        }\n      ];\n    });\n    const onToggleTransfer = () => {\n      transferMap.value = {\n        from: transferMap.value.to,\n        to: transferMap.value.from\n      };\n      transferCoinsAmount.value = \"\";\n      getUserCoin({});\n    };\n    const onMaxAmount = () => {\n      transferCoinsAmount.value = maxAvailableTransfer.value.toTruncFixed(2);\n    };\n    const onSubmit = async () => {\n      var _a;\n      if (!transferCoinsAmount.value) {\n        showToast({\n          message: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      if (+transferCoinsAmount.value < +minTransferAmount.value) {\n        showToast({\n          message: \"\\u8F93\\u5165\\u7684\\u6570\\u91CF\\u5C0F\\u4E8E\\u6700\\u5C0F\\u5212\\u8F6C\\u6570\\u91CF\",\n          icon: info,\n          iconSize: \"48px\"\n        });\n        return;\n      }\n      try {\n        const res = await getMoneyExchargeApi({\n          num: transferCoinsAmount.value,\n          mtype: transferMap.value.from.mtype,\n          coin_name: coinInfo.value.coin_name,\n          to_mtype: transferMap.value.to.mtype,\n          to_coin_name: toCoinInfo.value.coin_name\n        });\n        if (res[\"code\"] === 0) {\n          showToast({\n            message: \"\\u6210\\u529F\",\n            icon: success,\n            iconSize: \"48px\"\n          });\n          transferCoinsAmount.value = \"\";\n          getUserCoin({});\n        }\n        (_a = inputAmount.value) == null ? void 0 : _a.focus();\n      } catch (error) {\n        console.error(error);\n      }\n    };\n    const initAmountEvent = () => {\n      nextTick(() => {\n        const amountInputEl = document.querySelector(\".amount-input input\");\n        if (amountInputEl) {\n          amountInputEl.onkeydown = (e) => {\n            if ([\"-\", \"+\"].includes(e.key)) {\n              return e.preventDefault();\n            }\n          };\n        }\n      });\n    };\n    onMounted(() => {\n      getUserCoin({});\n      initAmountEvent();\n    });\n    return (_ctx, _cache) => {\n      const _component_van_field = _resolveComponent(\"van-field\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"img\", { src: _unref(transfer01) }, null, 8, _hoisted_5),\n            _hoisted_6\n          ]),\n          _createElementVNode(\n            \"div\",\n            {\n              class: _normalizeClass([\"coin-icon-name flex justify-between\", transferMap.value.from.mtype === 30 ? \"flex-col\" : \"flex-col-reverse\"])\n            },\n            [\n              _createElementVNode(\"div\", _hoisted_7, [\n                _createElementVNode(\"img\", { src: _unref(KGB01) }, null, 8, _hoisted_8),\n                _hoisted_9\n              ]),\n              _createElementVNode(\"div\", _hoisted_10, [\n                _createElementVNode(\"img\", { src: _unref(USDT01) }, null, 8, _hoisted_11),\n                _hoisted_12\n              ])\n            ],\n            2\n            /* CLASS */\n          ),\n          _createElementVNode(\"div\", _hoisted_13, [\n            _createElementVNode(\"img\", {\n              src: _unref(transfer02),\n              class: \"icon-transfer\",\n              onClick: onToggleTransfer\n            }, null, 8, _hoisted_14)\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _hoisted_16,\n          _createElementVNode(\"div\", _hoisted_17, [\n            _createCommentVNode(\" \\u5141\\u8BB8\\u8F93\\u5165\\u6570\\u5B57\\uFF0C\\u8C03\\u8D77\\u5E26\\u7B26\\u53F7\\u7684\\u7EAF\\u6570\\u5B57\\u952E\\u76D8 \"),\n            _createVNode(_component_van_field, {\n              modelValue: transferCoinsAmount.value,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => transferCoinsAmount.value = $event),\n              ref_key: \"inputAmount\",\n              ref: inputAmount,\n              type: \"number\",\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5212\\u8F6C\\u6570\\u91CF\",\n              class: \"amount-input\"\n            }, null, 8, [\"modelValue\"]),\n            _createElementVNode(\n              \"div\",\n              _hoisted_18,\n              _toDisplayString(transferMap.value.from.unit),\n              1\n              /* TEXT */\n            ),\n            _createElementVNode(\"div\", {\n              class: \"max-amount\",\n              onClick: onMaxAmount\n            }, \" \\u5168\\u90E8 \")\n          ]),\n          _createElementVNode(\"div\", _hoisted_19, [\n            (_openBlock(true), _createElementBlock(\n              _Fragment,\n              null,\n              _renderList(transferCoinsInfo.value, (item, index) => {\n                return _openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"row-item flex justify-between items-center\"\n                }, [\n                  _createElementVNode(\n                    \"div\",\n                    _hoisted_20,\n                    _toDisplayString(item.label),\n                    1\n                    /* TEXT */\n                  ),\n                  _createElementVNode(\"div\", _hoisted_21, [\n                    index === 2 ? (_openBlock(), _createElementBlock(\n                      \"span\",\n                      _hoisted_22,\n                      _toDisplayString(`1 ${transferMap.value.from.unit} \\u2248 ${item.value}`),\n                      1\n                      /* TEXT */\n                    )) : (_openBlock(), _createElementBlock(\n                      \"span\",\n                      {\n                        key: 1,\n                        class: _normalizeClass([\"amount\", { \"amount-bold\": index === 0 }])\n                      },\n                      _toDisplayString(item.value),\n                      3\n                      /* TEXT, CLASS */\n                    )),\n                    _createElementVNode(\n                      \"span\",\n                      _hoisted_23,\n                      _toDisplayString([0, 1, 4].includes(index) ? transferMap.value.from.unit : transferMap.value.to.unit),\n                      1\n                      /* TEXT */\n                    )\n                  ])\n                ]);\n              }),\n              128\n              /* KEYED_FRAGMENT */\n            ))\n          ])\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"btn-submit text-center\",\n          onClick: onSubmit\n        }, \" \\u786E\\u8BA4\\u5212\\u8F6C \")\n      ]);\n    };\n  }\n});\n"
        ],
        "names": [],
        "mappings": ";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,uBAA8B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;"
      }
    },
    {
      "name": "vite:style-import",
      "start": 1714699771558,
      "end": 1714699771558,
      "order": "post"
    },
    {
      "name": "vite:build-import-analysis",
      "start": 1714699771558,
      "end": 1714699771558,
      "order": "normal"
    },
    {
      "name": "vite:reporter",
      "start": 1714699771558,
      "end": 1714699771558,
      "order": "normal"
    }
  ]
}
