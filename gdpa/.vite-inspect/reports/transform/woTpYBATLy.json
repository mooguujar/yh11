{
  "resolvedId": "/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue",
  "transforms": [
    {
      "name": "vite:load-fallback",
      "result": "<script setup lang=\"ts\">\nimport { gameInfoDataApi, gameRankApi } from '@/apis/taskActivity'\nimport { useAuthStore } from '@/store/modules/auth'\nimport { useEntryStore } from '@/store/modules/entry'\nimport { IGameRankData } from '@/store/types/taskActivity'\nimport { getRandomNumber } from '@/utils/tools'\nimport { storeToRefs } from 'pinia'\nimport { computed, onMounted, onUnmounted, ref } from 'vue'\n\nconst EntryStore = useEntryStore()\nconst { config } = storeToRefs(EntryStore)\n\nconst authStore = useAuthStore()\nconst { userInfo } = storeToRefs(authStore)\n\nconst week = ref(1)\nconst weekOption = ref([\n  { text: '本周', value: 1 },\n  { text: '上周', value: -1 }\n])\nconst ranks = ref<IGameRankData[]>([] as IGameRankData[])\nconst showMax = ref(true)\nconst prizePoolMoney = ref('0')\n\nconst appUserInfo = JSON.parse(localStorage.getItem('app_user_info') ?? '{}')\n\nconst handleToggle = () => {\n  showMax.value = !showMax.value\n}\n\nconst hasMore = computed(() => ranks.value.length > 10)\nconst visibleRanks = computed(() => ranks.value.slice(0, showMax.value ? 10 : ranks.value.length))\n// 图片资源域名\nconst imgserver_url = computed(() => {\n  return (config.value.Web_Set_DefaultInfo?.imgserver_url as any)?.v || ''\n})\nconst userNickName = computed(() => userInfo.value?.nickname || '')\n\nconst onWeekChange = (week: number) => {\n  getRankData()\n}\n\nconst filterNickName = (nickname: string) => {\n  if (!nickname) return ''\n  if (nickname.length === 1) return nickname + '**'\n  if (nickname.length > 1 && nickname.length < 4)\n    return nickname.slice(0, 1) + '**' + nickname.slice(1)\n  return nickname.slice(0, 1) + '**' + nickname.slice(-2)\n}\n\nconst getRankData = async () => {\n  try {\n    const res = await gameRankApi({ week: week.value })\n    window.log('排行榜', res, userInfo.value?.nickname, userNickName.value)\n\n    ranks.value = res\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nconst getGameInfoData = async () => {\n  try {\n    const res = await gameInfoDataApi({})\n    window.log('个人游戏信息', res)\n    if (res.pools && Math.floor(res.pools) !== Math.floor(+prizePoolMoney.value)) {\n      prizePoolMoney.value = Math.floor(res.pools).toString().replace(/\\d/g, '0')\n      setTimeout(() => {\n        prizePoolMoney.value = Math.floor(res.pools).toString()\n      }, 20)\n    }\n  } catch (err) {\n    console.error(err)\n  }\n}\ngetGameInfoData().then(() => {\n  poolIncrease()\n})\n\nlet poolIncreaseTimer: NodeJS.Timeout | null\n// 3至5秒内随机增加奖池金额\nconst poolIncrease = () => {\n  const randomSec = getRandomNumber(3000, 5000)\n\n  poolIncreaseTimer && clearTimeout(poolIncreaseTimer)\n  poolIncreaseTimer = setTimeout(() => {\n    getGameInfoData()\n    poolIncrease()\n  }, randomSec)\n}\n\nonMounted(() => {\n  getRankData()\n})\nonUnmounted(() => {\n  poolIncreaseTimer && clearTimeout(poolIncreaseTimer)\n  poolIncreaseTimer = null\n})\n</script>\n\n<template>\n  <div class=\"ranking-list-container\">\n    <div class=\"prize-pool-bg\">\n      <div class=\"prize-pool-money\">\n        <CountTo\n          v-show=\"prizePoolMoney.length > 1\"\n          :count=\"prizePoolMoney\"\n        />\n      </div>\n    </div>\n    <!-- 排行榜内容 -->\n    <div class=\"ranking-content\">\n      <van-dropdown-menu :overlay=\"false\">\n        <van-dropdown-item\n          v-model=\"week\"\n          :options=\"weekOption\"\n          @change=\"onWeekChange\"\n        />\n      </van-dropdown-menu>\n\n      <div class=\"title-bg flex flex-col justify-center items-center text-[#f1d188]\">\n        <div class=\"text-[34px] font-bold\">{{ week === 1 ? '本周' : '上周' }}合成数量排行榜</div>\n        <div class=\"sub-title text-[21px] text-[#fb967f] whitespace-nowrap\">\n          排行榜豪礼每周一派奖，最高可得\n          <span class=\"text-[#f1d188]\">1888</span>\n          大奖\n        </div>\n      </div>\n\n      <div class=\"podium-bg\">\n        <template v-if=\"ranks.length\">\n          <div class=\"rank-2nd flex flex-col justify-between items-center\">\n            <div class=\"flex justify-between items-center text-[21px] text-[#f3aaae]\">\n              <!-- <span>{{ ranks[1].nickname.slice(0, 2) }}**{{ ranks[1].nickname.slice(-2) }}</span> -->\n              <span class=\"nickname truncate\">{{ filterNickName(ranks[1].nickname) }}</span>\n              <span>\n                <span class=\"text-[21px] text-[#fee902]\">{{ ranks[1].daily_num }}</span>\n                张\n              </span>\n            </div>\n            <img :src=\"imgserver_url + ranks[1].headimg\" />\n          </div>\n          <div class=\"rank-1st flex flex-col justify-between items-center\">\n            <div class=\"flex justify-between items-center text-[21px] text-[#f3aaae]\">\n              <!-- <span>{{ ranks[0].nickname.slice(0, 2) }}**{{ ranks[0].nickname.slice(-2) }}</span> -->\n              <span class=\"nickname truncate\">{{ filterNickName(ranks[0].nickname) }}</span>\n              <span>\n                <span class=\"text-[21px] text-[#fee902]\">\n                  {{ ranks[0].daily_num }}\n                </span>\n                张\n              </span>\n            </div>\n            <img :src=\"imgserver_url + ranks[0].headimg\" />\n          </div>\n          <div class=\"rank-3rd flex flex-col justify-between items-center\">\n            <div class=\"flex justify-between items-center text-[21px] text-[#f3aaae]\">\n              <!-- <span>{{ ranks[2].nickname.slice(0, 2) }}**{{ ranks[2].nickname.slice(-2) }}</span> -->\n              <span class=\"nickname truncate\">{{ filterNickName(ranks[2].nickname) }}</span>\n              <span>\n                <span class=\"text-[21px] text-[#fee902]\">{{ ranks[2].daily_num }}</span>\n                张\n              </span>\n            </div>\n            <img :src=\"imgserver_url + ranks[2].headimg\" />\n          </div>\n        </template>\n      </div>\n\n      <div class=\"list-bg-top\">\n        <div class=\"list-th flex justify-between items-end\">\n          <div>会员信息</div>\n          <div>排名</div>\n          <div>合成卡数</div>\n        </div>\n      </div>\n      <div class=\"list-bg-middle\">\n        <div\n          v-for=\"(item, index) in visibleRanks.slice(3)\"\n          :key=\"item.nickname\"\n          class=\"item-row\"\n          :class=\"{ 'item-row-self': item.nickname === (userNickName || appUserInfo.nickname) }\"\n        >\n          <div class=\"item-content flex justify-between items-center\">\n            <div class=\"user-info flex items-center\">\n              <img :src=\"imgserver_url + item.headimg\" />\n              <div class=\"ml-[15px] line-clamp-2\">\n                <!-- {{ item.nickname.slice(0, 2) }}***{{ item.nickname.slice(-2) }} -->\n                {{ filterNickName(item.nickname) }}\n              </div>\n            </div>\n            <div class=\"rank-num flex justify-center\">\n              {{ item.rank_num > 99 ? '99+' : item.rank_num }}\n            </div>\n            <div class=\"card-num flex justify-center\">{{ item.daily_num }}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"list-bg-bottom flex justify-center items-center\">\n        <div\n          v-if=\"hasMore\"\n          class=\"text-[25px] text-[#eb8f6f]\"\n          @click=\"handleToggle\"\n        >\n          {{ showMax ? '展示更多' : '收起' }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.ranking-list-container {\n  width: 100%;\n  position: absolute;\n  top: 446px;\n  .prize-pool-bg {\n    position: relative;\n    width: 100%;\n    height: 203px;\n    background: url('@/assets/images/activity/jiangchi.png') no-repeat center / cover;\n    background-size: 100% 100%;\n    .prize-pool-money {\n      position: absolute;\n      top: 40px;\n      left: 298px;\n      width: 238px;\n      height: 83px;\n      overflow: hidden;\n      :deep(.content) {\n        width: 238px;\n        height: 83px;\n        justify-content: flex-start;\n        .digital_wrap {\n          width: auto;\n        }\n        .digital {\n          background-image: linear-gradient(#fdf4a7, #fdd73e);\n          background-image: -webkit-linear-gradient(#fdf4a7, #fdd73e);\n          color: transparent;\n          background-clip: text;\n          -webkit-background-clip: text;\n        }\n        .icon {\n          height: auto;\n          background-image: linear-gradient(#fdf4a7, #fdd73e);\n          background-image: -webkit-linear-gradient(#fdf4a7, #fdd73e);\n          color: transparent;\n          background-clip: text;\n          -webkit-background-clip: text;\n          display: inline-block;\n        }\n      }\n    }\n  }\n  .ranking-content {\n    position: relative;\n    width: 100%;\n    height: auto;\n    padding: 8px 13px 0 13px;\n    background: url('@/assets/images/activity/jiangchi_bg.png') center / cover;\n    background-size: 100% 100%;\n\n    :deep(.van-dropdown-menu) {\n      position: relative;\n      width: 130px;\n      height: 44px;\n      border: 1px solid rgba(241, 209, 136, 0.8);\n      border-radius: 6px;\n      .van-dropdown-menu__bar {\n        width: 130px;\n        height: 44px;\n        background-color: transparent;\n        .van-dropdown-menu__item {\n          // justify-content: flex-start;\n        }\n        .van-dropdown-menu__title {\n          height: 44px;\n          line-height: 44px;\n          padding: 0 15px 0 5px;\n          font-size: 22px;\n          color: #f1d188;\n          letter-spacing: 5px;\n          &::after {\n            border-color: transparent transparent #f1d188 #f1d188;\n          }\n        }\n      }\n      .van-dropdown-item {\n        width: 130px;\n        height: 90px;\n        position: absolute;\n        left: -1px;\n        top: 39px !important;\n        border: 1px solid rgba(241, 209, 136, 0.8);\n        border-bottom-left-radius: 6px;\n        border-bottom-right-radius: 6px;\n        .van-popup {\n          background-color: transparent;\n          max-height: unset;\n        }\n        .van-cell {\n          height: 44px;\n          padding: 0;\n          background-color: transparent;\n          font-size: 22px;\n          color: #f1d188;\n          letter-spacing: 5px;\n          text-align: center;\n          &::after {\n            display: none;\n          }\n        }\n        .van-dropdown-item__option--active {\n          background-color: #b21731;\n          color: #f1d188;\n        }\n        .van-cell__value {\n          display: none;\n        }\n      }\n    }\n\n    .title-bg {\n      position: relative;\n      width: 400px;\n      height: 90px;\n      padding: 16px 0 11px 0;\n      background: url('@/assets/images/activity/ranking-title-bg.png') no-repeat center / cover;\n      background-size: 100% 100%;\n      position: absolute;\n      top: 0;\n      left: 50%;\n      transform: translate3d(-50%, 0, 0);\n      .sub-title {\n        position: absolute;\n        top: 100px;\n        left: 50%;\n        transform: translate3d(-50%, 0, 0);\n      }\n    }\n\n    .podium-bg {\n      position: relative;\n      width: 652px;\n      height: 104px;\n      margin: 235px auto 28px auto;\n      background: url('@/assets/images/activity/podium.png') no-repeat center / cover;\n      background-size: 100% 100%;\n      img {\n        width: 83px;\n        height: 83px;\n        box-shadow: 0px 5px 5px 0px rgba(89, 9, 4, 0.98);\n        border-radius: 14px;\n        border: solid 1px rgba(241, 209, 136, 0.8);\n      }\n      .rank-2nd {\n        width: 200px;\n        height: 120px;\n        position: absolute;\n        left: 20px;\n        bottom: 75px;\n      }\n      .rank-1st {\n        width: 200px;\n        height: 120px;\n        position: absolute;\n        left: 50%;\n        bottom: 103px;\n        transform: translate3d(-50%, 0, 0);\n      }\n      .rank-3rd {\n        width: 200px;\n        height: 120px;\n        position: absolute;\n        right: 20px;\n        bottom: 50px;\n      }\n      .nickname {\n        max-width: 100px;\n        margin-right: 10px;\n      }\n    }\n    .list-bg-top {\n      width: 722px;\n      height: 60px;\n      background: url('@/assets/images/activity/bg_phb1.png') no-repeat center / cover;\n      background-size: 100% 100%;\n      .list-th {\n        padding: 28px 100px 4px 100px;\n        font-size: 25px;\n        font-weight: bold;\n        color: #b0170d;\n      }\n    }\n    .list-bg-middle {\n      width: 722px;\n      height: auto;\n      margin-top: -2px;\n      padding: 20px 6px 0 6px;\n      background: url('@/assets/images/activity/bg_phb2.png') no-repeat center / cover;\n      background-size: 100% 100%;\n      .item-row {\n        padding: 0 23px 0 38px;\n        &-self {\n          background-color: #f8e4cb;\n          border-radius: 14px;\n        }\n      }\n      .item-content {\n        position: relative;\n        padding: 25px 96px 25px 10px;\n        font-size: 25px;\n        color: #995b3d;\n        &::after {\n          content: '';\n          position: absolute;\n          left: 0;\n          bottom: 0;\n          width: 100%;\n          height: 3px;\n          background: url('@/assets/images/activity/border-bg.png') no-repeat center / cover;\n          background-size: 100% 100%;\n        }\n      }\n      .user-info {\n        width: 200px;\n        img {\n          width: 76px;\n          height: 76px;\n          border-radius: 14px;\n        }\n      }\n      .rank-num {\n        width: 44px;\n        margin: 0 auto 0 85px;\n      }\n      .card-num {\n        width: 48px;\n      }\n    }\n    .list-bg-bottom {\n      width: 722px;\n      height: 80px;\n      margin-top: -2px;\n      background: url('@/assets/images/activity/bg_phb3.png') no-repeat center / cover;\n      background-size: 100% 100%;\n    }\n  }\n}\n</style>\n",
      "start": 1714699769442,
      "end": 1714699769504,
      "sourcemaps": null
    },
    {
      "name": "vite:css",
      "start": 1714699769504,
      "end": 1714699769504,
      "order": "normal"
    },
    {
      "name": "vite:esbuild",
      "start": 1714699769504,
      "end": 1714699769504,
      "order": "normal"
    },
    {
      "name": "vite:json",
      "start": 1714699769504,
      "end": 1714699769504,
      "order": "normal"
    },
    {
      "name": "vite:worker",
      "start": 1714699769504,
      "end": 1714699769504,
      "order": "normal"
    },
    {
      "name": "vite:vue",
      "result": "import _sfc_main from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nimport \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\";\nimport _export_sfc from \"\\0plugin-vue:export-helper\";\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-cef08ad0\"], [\"__file\", \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"]]);\n",
      "start": 1714699769504,
      "end": 1714699769606,
      "order": "normal",
      "sourcemaps": {
        "mappings": ""
      }
    },
    {
      "name": "vite:vue-jsx",
      "start": 1714699769606,
      "end": 1714699769606,
      "order": "normal"
    },
    {
      "name": "vite-plugin-vconsole",
      "result": "import _sfc_main from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nimport \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\";\nimport _export_sfc from \"\\0plugin-vue:export-helper\";\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-cef08ad0\"], [\"__file\", \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"]]);\n",
      "start": 1714699769606,
      "end": 1714699769606,
      "order": "normal",
      "sourcemaps": null
    },
    {
      "name": "esbuild",
      "result": "\"use strict\";\nimport _sfc_main from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nimport \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\";\nimport _export_sfc from \"\\0plugin-vue:export-helper\";\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-cef08ad0\"], [\"__file\", \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"]]);\n",
      "start": 1714699769606,
      "end": 1714699770584,
      "order": "normal",
      "sourcemaps": "{\n  \"version\": 3,\n  \"sources\": [\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"],\n  \"sourcesContent\": [\"import _sfc_main from \\\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\\\";\\nexport * from \\\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\\\";\\nimport \\\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\\\";\\nimport _export_sfc from \\\"\\\\0plugin-vue:export-helper\\\";\\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\\\"__scopeId\\\", \\\"data-v-cef08ad0\\\"], [\\\"__file\\\", \\\"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\\\"]]);\\n\"],\n  \"mappings\": \";AAAA,OAAO,eAAe;AACtB,cAAc;AACd,OAAO;AACP,OAAO,iBAAiB;AACxB,eAA+B,4BAAY,WAAW,CAAC,CAAC,aAAa,iBAAiB,GAAG,CAAC,UAAU,0EAA0E,CAAC,CAAC;\",\n  \"names\": []\n}\n"
    },
    {
      "name": "vite:define",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:css-post",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:build-html",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:worker-import-meta-url",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:asset-import-meta-url",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "commonjs",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:dynamic-import-vars",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "vite:import-glob",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "normal"
    },
    {
      "name": "unplugin-auto-import",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "post"
    },
    {
      "name": "unplugin-vue-components",
      "result": "/* unplugin-vue-components disabled */\"use strict\";\nimport _sfc_main from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nimport \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\";\nimport _export_sfc from \"\\0plugin-vue:export-helper\";\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-cef08ad0\"], [\"__file\", \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"]]);\n",
      "start": 1714699770584,
      "end": 1714699770584,
      "order": "post",
      "sourcemaps": {
        "version": 3,
        "sources": [
          "/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue"
        ],
        "sourcesContent": [
          "\"use strict\";\nimport _sfc_main from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=script&setup=true&lang.ts\";\nimport \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue?vue&type=style&index=0&scoped=cef08ad0&lang.scss\";\nimport _export_sfc from \"\\0plugin-vue:export-helper\";\nexport default /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-cef08ad0\"], [\"__file\", \"/Users/afeng/Desktop/work/gdpayh5-web/src/pages/Activity/RankingList.vue\"]]);\n"
        ],
        "names": [],
        "mappings": "sCAAA;AACA;AACA;AACA;AACA;AACA;"
      }
    },
    {
      "name": "vite:style-import",
      "start": 1714699770585,
      "end": 1714699770585,
      "order": "post"
    },
    {
      "name": "vite:build-import-analysis",
      "start": 1714699770585,
      "end": 1714699770585,
      "order": "normal"
    },
    {
      "name": "vite:reporter",
      "start": 1714699770585,
      "end": 1714699770585,
      "order": "normal"
    }
  ]
}
